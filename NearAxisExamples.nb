(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    219665,       5714]
NotebookOptionsPosition[    211088,       5579]
NotebookOutlinePosition[    211456,       5595]
CellTagsIndexPosition[    211413,       5592]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Near-Axis Expansion for Isoprominence: Examples", "Title",
 CellChangeTimes->{{3.834692435722969*^9, 3.834692456449649*^9}, {
  3.862590414692609*^9, 3.862590426285365*^9}, {3.873318393456724*^9, 
  3.8733184049676323`*^9}, {3.8733291737045918`*^9, 
  3.873329175432819*^9}},ExpressionUUID->"e86d89f5-bd28-4f5c-aaba-\
35d1096f7754"],

Cell[TextData[{
 "This notebook is a companion to the paper ",
 StyleBox["CITE. ",
  FontWeight->"Bold"],
 "The function names in this notebook are the same as in the paper.",
 StyleBox["\n",
  FontWeight->"Bold"],
 "It explores the two examples of near-axis, approximately isoprominent \
fields contained in the paper."
}], "Text",
 CellChangeTimes->{{3.8606391091915083`*^9, 3.860639244989071*^9}, {
  3.87331841978414*^9, 3.8733184211281357`*^9}, {3.8733185279100437`*^9, 
  3.873318537279661*^9}, {3.873318587919697*^9, 3.87331861220776*^9}, {
  3.873329200177587*^9, 3.873329239961247*^9}, {3.8733297051123333`*^9, 
  3.873329738026574*^9}},ExpressionUUID->"20dd0ee3-74ec-49a4-ac9a-\
d9caa9dbf955"],

Cell[CellGroupData[{

Cell["Initialisation", "Chapter",
 CellChangeTimes->{{3.8606393415885878`*^9, 3.8606393588169813`*^9}, {
  3.873319603527544*^9, 
  3.8733196319516068`*^9}},ExpressionUUID->"dbb3074b-cbbd-427f-9927-\
1b44ccb0a50e"],

Cell[TextData[{
 StyleBox["Requirements: ",
  FontWeight->"Bold"],
 "In order to run the examples the notebook ",
 StyleBox["IsoprominenceConditions.nb",
  FontSlant->"Italic"],
 " needs to first be run with ",
 StyleBox["order = 3 ",
  FontSlant->"Italic"],
 "to generate ",
 StyleBox["hsols_3.wdx, Bdiv0_3.wdx.\n",
  FontSlant->"Italic"],
 "These files must also be sitting in the same directory as this notebook."
}], "Text",
 CellChangeTimes->{{3.87332933900851*^9, 3.873329426369565*^9}, {
  3.8733295631053257`*^9, 3.873329667490007*^9}, {3.873330748629477*^9, 
  3.873330767789143*^9}},ExpressionUUID->"94e1c713-3eef-4ac8-8f10-\
9a1207680f89"],

Cell[CellGroupData[{

Cell["Mathematica Utility Functions", "Subsection",
 CellChangeTimes->{{3.860639405263054*^9, 
  3.860639420885694*^9}},ExpressionUUID->"8af2adab-2348-489b-9326-\
5942de0b98f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Package", " ", "needed", " ", "for", " ", 
    RowBox[{"Combinations", "[", "]"}], " ", "function"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Quiet", "[", 
   RowBox[{"<<", "Combinatorica`"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.860693866372081*^9, 3.86069387092721*^9}, {
  3.860694350510363*^9, 3.8606943743379793`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"1c445717-ef21-4bd2-8a69-68e4c7275dfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "function", " ", "which", " ", "takes", " ", "output", " ", "of", " ", 
    "Solve", " ", "and", " ", "turns", " ", "functions", " ", "into", " ", 
    "explicit", " ", "Function", " ", "commands"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SolveToFunction", "[", "sols_", "]"}], ":=", 
    RowBox[{"sols", "/.", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"e_", "[", "s_", "]"}], ",", "expr_"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{"Rule", "[", 
       RowBox[{"e", ",", 
        RowBox[{"Function", "[", 
         RowBox[{"S", ",", 
          RowBox[{"expr", "/.", 
           RowBox[{"s", "\[Rule]", "S"}]}]}], "]"}]}], "]"}]}]}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Creates", " ", "list", " ", "of", " ", "all", " ", "monomials", " ", 
      "in", " ", "X"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "}"}], " ", "of", " ", 
      "order", " ", "d"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Monomials", "[", 
      RowBox[{"X_", ",", "d_"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Times", "@@", 
         RowBox[{"(", 
          RowBox[{"X", "^", "#"}], ")"}]}], "&"}], ",", 
       RowBox[{"Compositions", "[", 
        RowBox[{"d", ",", 
         RowBox[{"Length", "[", "X", "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generate", " ", "an", " ", "arbitrary", " ", "homogeneous", " ", 
     "polynomial", " ", "of", " ", "degree", " ", "d"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HomPolynomial", "::", "usage"}], " ", "=", " ", 
     "\"\<HomPolynomial[{x,y,...},d,h] returns an arbitrary homogeneous \
polynomial of degree d in {x,y,...} with coefficient handle h. The option \
Coefficients->True will return the coefficients as a list in the form \
{poly,coeffs}\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "HomPolynomial", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"Coefficients", "\[Rule]", "False"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HomPolynomial", "[", 
      RowBox[{"X_", ",", "d_", ",", "h_", ",", 
       RowBox[{"opts", " ", ":", " ", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"terms", ",", "coeffs", ",", "polys", ",", "n"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"terms", " ", "=", " ", 
         RowBox[{"Monomials", "[", 
          RowBox[{"X", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coeffs", " ", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"h", "@@", "#"}], "&"}], "/@", 
           RowBox[{"Compositions", "[", 
            RowBox[{"d", ",", "n"}], "]"}]}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polys", " ", "=", 
         RowBox[{"coeffs", ".", "terms"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Coefficients", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"polys", ",", "coeffs"}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "polys", "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generate", " ", "an", " ", "arbitrary", " ", "polynomial", " ", "of", 
     " ", "degree", " ", "d"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Polynomial", "::", "usage"}], " ", "=", " ", 
     "\"\<Polynomial[{x,y,...},d,h] returns an arbitrary polynomial of degree \
d in {x,y,...} with coefficient handle h. The option Coefficients->True will \
return the coefficients as a list in the form {poly,coeffs}\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Polynomial", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"Coefficients", "\[Rule]", "False"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Polynomial", "[", 
      RowBox[{"X_", ",", "d_", ",", "h_", ",", 
       RowBox[{"opts", " ", ":", " ", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polyinfo", ",", "poly", ",", "coeffs"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Coefficients", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"polyinfo", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"i", ",", 
               RowBox[{"HomPolynomial", "[", 
                RowBox[{"X", ",", "i", ",", "h", ",", 
                 RowBox[{"Coefficients", "\[Rule]", "True"}]}], "]"}]}], 
              "]"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "d"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"poly", "=", 
           RowBox[{"Plus", "@@", 
            RowBox[{
            "polyinfo", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"coeffs", "=", 
           RowBox[{
           "polyinfo", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"poly", ",", "coeffs"}], "}"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Plus", "@@", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"i", ",", 
             RowBox[{"HomPolynomial", "[", 
              RowBox[{"X", ",", "i", ",", "h"}], "]"}]}], "]"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "d"}], "]"}]}]}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8606924610721073`*^9, 3.860692461323895*^9}, {
   3.8606925678327227`*^9, 3.860692611898024*^9}, {3.860692645895104*^9, 
   3.86069270177814*^9}, {3.860692739250847*^9, 3.8606930406532173`*^9}, {
   3.860693623702951*^9, 3.860693795592484*^9}, 3.860693843409361*^9, {
   3.860694423654756*^9, 3.860694493767758*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"87d5cd1b-bfce-4377-b111-259d989131fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"For", " ", "Taylor", " ", "series", " ", "expansions"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Taylor", "::", "usage"}], " ", "=", " ", 
     "\"\<Taylor[vf, vars, k] produces the k-jet of the vector field vf in \
variables vars.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Taylor", "[", 
      RowBox[{"vf_", ",", "vars_", ",", "deg_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ctraf", ",", "vftemp", ",", "c"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"ctraf", " ", "=", " ", 
         RowBox[{"Thread", "[", 
          RowBox[{"vars", "->", 
           RowBox[{"c", " ", "vars"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"vftemp", " ", "=", 
         RowBox[{
          RowBox[{"Series", "[", " ", 
           RowBox[{
            RowBox[{"vf", "/.", "ctraf"}], ",", 
            RowBox[{"{", 
             RowBox[{"c", ",", "0", ",", "deg"}], "}"}]}], "]"}], "//", 
          "Normal"}]}], ";", "\n", "\t", 
        RowBox[{"vftemp", "/.", 
         RowBox[{"c", "->", "1"}]}]}]}], "\n", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "A", " ", "common", " ", "simplification", " ", "that", " ", "collects", 
      " ", "x"}], ",", 
     RowBox[{
     "y", " ", "terms", " ", "and", " ", "simplifies", " ", 
      "coefficients"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Collectxy", "[", "expr_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{"expr", "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
           RowBox[{"\[Epsilon]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], ",", "\[Epsilon]", 
        ",", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "Simplify"}], "]"}], "&"}]}],
        "]"}], "/.", 
      RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8606951517590837`*^9, 3.860695195987245*^9}, {
  3.860695334039276*^9, 3.8606954081627483`*^9}, {3.873318501778306*^9, 
  3.873318503176111*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"152c4574-8d07-4439-b323-d4934afda311"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Importing hsols", "Subsection",
 CellChangeTimes->{{3.873329549025193*^9, 
  3.873329555137259*^9}},ExpressionUUID->"9f04adcf-598a-4026-a55d-\
1bae40affe45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hsols", "=", 
   RowBox[{"Import", "[", "\"\<hsols_3.wdx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bdiv0", "[", "]"}], "=", 
   RowBox[{"Import", "[", "\"\<Bdiv0_3.wdx\>\"", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873329586805664*^9, 3.873329600793647*^9}, {
  3.8733296333854933`*^9, 3.8733296735778027`*^9}, {3.873330721288105*^9, 
  3.873330738077791*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"41e17064-d2b7-4397-bddf-49925e6f379c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Chapter",
 CellChangeTimes->{{3.837131808548189*^9, 
  3.837131810095121*^9}},ExpressionUUID->"98e1dbd4-7b0f-4985-9b62-\
d549777a510a"],

Cell[CellGroupData[{

Cell["Example 1", "Subsection",
 CellChangeTimes->{{3.8371318187301693`*^9, 3.837131846018976*^9}, {
  3.862590656876403*^9, 
  3.8625906571084137`*^9}},ExpressionUUID->"fa03a257-ed9d-4be8-9e1b-\
ed1b3369e3d9"],

Cell["\<\
This is Example 1 of the paper. It is a degree 4 polynomial vector-field in \
x,y which satisfies isoprominence to order 3.\
\>", "Text",
 CellChangeTimes->{{3.873329884801811*^9, 3.873329890554223*^9}, {
  3.873330155546858*^9, 
  3.87333018555558*^9}},ExpressionUUID->"9fdf4663-0503-46e5-85f4-\
a98df6be4964"],

Cell[CellGroupData[{

Cell["Equations defining the example", "Subsubsection",
 CellChangeTimes->{{3.835235642240221*^9, 3.835235644316049*^9}, {
  3.873329456672782*^9, 
  3.8733294644490147`*^9}},ExpressionUUID->"11e1f84b-7325-484b-be4b-\
f29b98e48940"],

Cell[TextData[{
 "We choose ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["B", "0"], "(", "s", ")"}], " ", "=", " ", 
    RowBox[{
     SubscriptBox["C", "0"], 
     SuperscriptBox["e", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"F", "(", "s", ")"}], "-", 
         RowBox[{"F", "(", "0", ")"}]}], ")"}]}]]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "bd609dcb-0968-4d4a-b5d5-7a0f6f0877bc"],
 " such that \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "(", "s", ")"}], " ", "=", " ", 
    RowBox[{
     FractionBox["1", "10"], 
     RowBox[{"cos", "(", "s", ")"}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "680f29d5-b1c4-4c0c-b064-5658e304d203"],
 ", \t ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"F", "'"}], 
     RowBox[{"(", "s", ")"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "10"]}], 
     RowBox[{"sin", "(", "s", ")"}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b8b90891-b7bf-4b8f-8463-49d677329970"],
 ".\nThis guarantees that ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalSigma]", "-"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f7292e3c-e9f6-4422-9e16-42764dc1cd63"],
 " only intersects the magnetic axis at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    RowBox[{"y", "=", "0"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b16a31e3-5891-43ca-856c-553d36ed9628"],
 " when ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["s", "*"], "=", "0"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2ed4a4f2-c577-4ff6-9ad2-c0229df20a27"],
 ".\n\nWe choose the axis to be a simple circle so that \[Kappa](s) = ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Kappa]", "0"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "99480d57-1095-49be-81b2-ea108da2a755"],
 " (const) and \[Tau](s) = 0\n\nThe order = 3."
}], "Text",
 CellChangeTimes->{{3.8352389746052027`*^9, 3.835239015307538*^9}, {
   3.835239080296011*^9, 3.835239101410684*^9}, {3.835923120408251*^9, 
   3.8359232539791193`*^9}, {3.835923296774247*^9, 3.835923301792025*^9}, {
   3.837131861036378*^9, 3.8371318941732817`*^9}, 3.860638261365808*^9, {
   3.8622506779759827`*^9, 3.862250696699889*^9}, 3.8622507385446587`*^9, {
   3.862590667157197*^9, 3.862590680982147*^9}, 3.873329539993155*^9, {
   3.873329746906281*^9, 3.8733297494823513`*^9}, {3.8733298947625723`*^9, 
   3.873330147740099*^9}, {3.873330191700592*^9, 
   3.8733301952760277`*^9}},ExpressionUUID->"d5ca1a3b-d7fd-4154-bf16-\
56ce1e1c14d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "s_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "10"}], 
    RowBox[{"Cos", "[", "s", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "F", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B0sub", "=", 
   RowBox[{"B0", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{"s", ",", 
      RowBox[{"Exp", "[", " ", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", "s", "]"}], "-", 
          RowBox[{"F", "[", "0", "]"}]}], ")"}]}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fsub", "=", 
   RowBox[{"F", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{"1", "/", "10"}], 
       RowBox[{"Cos", "[", "s", "]"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"2", "\[Pi]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"The", " ", "period", " ", "of", " ", "s"}], "-", "coordinate"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"order", " ", "=", " ", "3"}], ";"}]}], "Input",
 CellChangeTimes->{{3.835923731532188*^9, 3.835923842277499*^9}, {
  3.835924650543433*^9, 3.835924655520781*^9}, {3.8371318995472507`*^9, 
  3.837131899843115*^9}, {3.840060870838526*^9, 3.840060872739153*^9}, {
  3.862251646373827*^9, 3.8622516477849483`*^9}, {3.86225172969318*^9, 
  3.86225174264642*^9}, {3.873330209733386*^9, 3.8733302436283083`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"d3a67aee-6952-4d25-84e2-d3e050c90db7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Curve", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"curveVals", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Kappa]", "\[Rule]", 
       RowBox[{"Function", "[", 
        RowBox[{"s", ",", "\[Kappa]0"}], "]"}]}], ",", 
      RowBox[{"\[Tau]", "\[Rule]", 
       RowBox[{"Function", "[", 
        RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.835239106504346*^9, 3.8352391083697844`*^9}, {
   3.83523915513223*^9, 3.835239156328541*^9}, 3.8352394473784847`*^9, {
   3.862250735768674*^9, 3.862250736441684*^9}, {3.873330259973456*^9, 
   3.8733302619000587`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"f0f0a87f-4d64-4589-a128-855bec228a3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Turning", " ", "the", " ", "isoprominent", " ", "condition", " ", "into", 
    " ", "a", " ", "function", " ", "substitution", " ", "called", " ", 
    "hrules"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"hsolfun", "=", 
     RowBox[{
      RowBox[{"SolveToFunction", "[", "hsols", "]"}], "//", "Flatten"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"Rule", "[", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}], "//.", 
          "hsolfun"}]}], "]"}], "]"}], "&"}], "/@", "hsols"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hrules", "=", 
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"B0", "'"}], "[", "st", "]"}], "\[Rule]", "0"}]}], "//", 
      "Flatten"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8622599086522093`*^9, 3.862260058566866*^9}, {
  3.86226010192946*^9, 3.86226010743011*^9}, {3.8733303910152597`*^9, 
  3.8733304322526293`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"fca5e18f-a3f1-473b-8fcc-1d5ecee2479a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Substituing", " ", "parameter", " ", "values", " ", "into", " ", 
     "hrules", " ", "and", " ", "taking", " ", 
     SuperscriptBox["s", "*"]}], "=", "0"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"intconds", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"hrules", "/.", "B0sub"}], "/.", "curveVals"}], "/.", "Fsub"}], 
    "/.", 
    RowBox[{"st", "\[Rule]", "0"}]}]}]}]], "Input",
 CellChangeTimes->{{3.862260114032703*^9, 3.862260176257627*^9}, {
  3.873330466382553*^9, 3.873330488388843*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"76999f5b-688c-4a1e-a63e-58633a748fbd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "[", "0", "]"}], "\[Rule]", "0"}], ",", 
   
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    "\[Kappa]0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"0", ",", "2"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "8"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], "2"]}],
        "-", 
       SuperscriptBox[
        RowBox[{
         RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], ")"}]}]}],
    ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"1", ",", "1"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{
      RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["\[Kappa]0", "2"]}], "-", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], "2"]}],
        "-", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}]}], 
      ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"0", ",", "3"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "12"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], "[", "0", "]"}]}], "-", 
       RowBox[{"6", " ", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], " ", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "2", "]"}], "[", "0", "]"}]}]}], ")"}]}]}], 
   ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "24"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "9"}], " ", "\[Kappa]0", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], "2"],
           "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], 
         ")"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", 
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
           
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", 
               RowBox[{"2", ",", "0"}], "]"}], "[", "0", "]"}], "+", 
             RowBox[{
              RowBox[{"\[Mu]", "[", "2", "]"}], "[", "0", "]"}]}], ")"}]}], 
          "+", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", 
             RowBox[{"2", ",", "1"}], "]"}], "[", "0", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", " ", 
              RowBox[{
               RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}]}], "-", 
             RowBox[{"3", " ", 
              RowBox[{
               RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}]}], 
            ")"}]}]}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"2", ",", "1"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "12"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", 
          RowBox[{"2", ",", "0"}], "]"}], "[", "0", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{
            RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}]}], ")"}]}], 
       "-", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", 
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", 
             RowBox[{"2", ",", "1"}], "]"}], "[", "0", "]"}]}], "+", 
          RowBox[{"9", " ", "\[Kappa]0", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "-", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}], ")"}]}], 
          "-", 
          RowBox[{"6", " ", 
           RowBox[{
            RowBox[{"\[Nu]", "[", "2", "]"}], "[", "0", "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"3", ",", "0"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["125", "6"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"6", " ", 
          SuperscriptBox["\[Kappa]0", "3"]}], "125"]}], "+", 
       RowBox[{
        FractionBox["1", "500"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", 
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
           
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", 
             RowBox[{"2", ",", "0"}], "]"}], "[", "0", "]"}]}], "+", 
          RowBox[{"9", " ", "\[Kappa]0", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{
               RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], 
              "2"], "+", 
             SuperscriptBox[
              RowBox[{
               RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], 
            ")"}]}], "+", 
          RowBox[{"12", " ", 
           RowBox[{
            RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}], " ", 
           RowBox[{
            RowBox[{"\[Nu]", "[", "2", "]"}], "[", "0", "]"}]}]}], ")"}]}]}], 
      ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8622601149628277`*^9, 3.862260146223312*^9}, 
   3.86226017675712*^9, 3.862620218126524*^9, 3.863208123603612*^9, 
   3.8643449176303453`*^9, 3.873330489178093*^9, 3.873331263968133*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"41b1c874-2bf2-4191-a503-354a1b4beae1"]
}, Open  ]],

Cell["\<\
The above is what needs to be true to satisfy isoprominence to order 3.
As per the paper, we choose the interpolations so that hrules is satisfied \
for all s, that is, the s-component of B is independent of s.
The result is BsRules which specifies the coefficients of x,y in B for \
isoprominence.\
\>", "Text",
 CellChangeTimes->{{3.835239201556134*^9, 3.835239208711825*^9}, {
  3.835239280141889*^9, 3.8352392947546577`*^9}, {3.8622512856317167`*^9, 
  3.862251296700499*^9}, {3.8626202242917337`*^9, 3.862620233684012*^9}, {
  3.873330495508973*^9, 
  3.873330591347292*^9}},ExpressionUUID->"199e1920-a6af-4c0c-9709-\
fbb07c118349"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BsRules", "=", 
   RowBox[{"intconds", "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"Bs", "[", 
       RowBox[{"j_", ",", "k_"}], "]"}], "[", "0", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"Bs", "[", 
       RowBox[{"j", ",", "k"}], "]"}], "[", "s", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BsRules", "=", 
   RowBox[{"SolveToFunction", "[", "BsRules", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.86225923533762*^9, 3.862259298872529*^9}, {
  3.8622593520960817`*^9, 3.862259546147488*^9}, {3.862260181754199*^9, 
  3.862260240004695*^9}, {3.862260282168653*^9, 3.8622602942464237`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"6ad5577f-f637-4fd5-8fca-bc18eac09fef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "checks", " ", "that", " ", "the", " ", "isoprominent", " ", 
    "conditions", " ", "have", " ", "been", " ", "met"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "It", " ", "should", " ", "evaluate", " ", "to", " ", "a", " ", "vector", 
    " ", "of", " ", "zeroes"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"intconds", "/.", 
     RowBox[{"Rule", "\[Rule]", "Subtract"}]}], "/.", "BsRules"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.8359240633577337`*^9, 3.835924159473929*^9}, {
   3.835924230994185*^9, 3.835924256256752*^9}, {3.862251442439541*^9, 
   3.862251464302438*^9}, 3.862251777228237*^9, {3.86225186093513*^9, 
   3.8622518918038597`*^9}, {3.862259652541972*^9, 3.862259688176694*^9}, {
   3.862260248176412*^9, 3.862260301641985*^9}, {3.873330598124761*^9, 
   3.87333062600986*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"d8d7b524-2112-4a89-a98e-57be64331c4c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.835924070293025*^9, 3.8359241615754747`*^9}, {
   3.835924227999518*^9, 3.8359242574473963`*^9}, 3.8364425503887663`*^9, 
   3.8364427239126873`*^9, 3.837131916799596*^9, {3.840060925399135*^9, 
   3.840060935855042*^9}, 3.840061022375949*^9, 3.860099005392692*^9, {
   3.862251450019107*^9, 3.862251464788444*^9}, 3.862251777541975*^9, 
   3.862251828909487*^9, {3.862251862959042*^9, 3.862251892412747*^9}, 
   3.862259054423976*^9, 3.862259130984345*^9, {3.862259626397771*^9, 
   3.862259688516056*^9}, {3.862260243859006*^9, 3.86226030190038*^9}, 
   3.8626202671103907`*^9, 3.863208123698937*^9, 3.864344920468285*^9, {
   3.873330610464554*^9, 3.873330626309017*^9}, 3.8733312681582623`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"f4265a60-82fe-4812-9f13-a0403adbf879"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"The", " ", "B"}], "-", 
    RowBox[{"field", " ", "of", " ", "example1"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Bexam", "=", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Bdiv0", "[", "]"}], "//.", "BsRules"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
          RowBox[{"\[Epsilon]", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], ",", "\[Epsilon]"}], 
      "]"}], "/.", 
     RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.835235670401506*^9, 3.8352357855599327`*^9}, {
   3.835238530043662*^9, 3.835238535878191*^9}, {3.835239424229329*^9, 
   3.835239439600597*^9}, {3.835924310724128*^9, 3.8359243180867662`*^9}, {
   3.8622519011500072`*^9, 3.86225190685332*^9}, {3.862252059056177*^9, 
   3.862252066902657*^9}, {3.862255035698954*^9, 3.8622550694446287`*^9}, 
   3.862256709186388*^9, {3.873331274563802*^9, 3.8733312773224087`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"c3dc9350-d76e-4747-a355-392e8229e50d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Order", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Inputting", " ", "the", " ", "desired", " ", "linear", " ", "terms", " ", 
    "of", " ", "B", " ", "for", " ", "example", " ", "1", " ", "in", " ", 
    "paper"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"funs1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Mu]", "[", "1", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", 
          RowBox[{"2", 
           RowBox[{"B0", "[", "s", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"C", "[", "1", "]"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"2", 
               RowBox[{"F", "[", "s", "]"}]}], "]"}]}], ")"}]}]}], "]"}]}], 
       ",", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "1", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", 
          RowBox[{"2", 
           SuperscriptBox[
            RowBox[{"C", "[", "1", "]"}], 
            RowBox[{"-", "1"}]], 
           RowBox[{"B0", "[", "s", "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "2"}], 
             RowBox[{"F", "[", "s", "]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "\[Iota]0"}], "T"], ")"}], "2"]}],
              "+", 
             RowBox[{
              RowBox[{"F", "''"}], "[", "s", "]"}], "-", 
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalDelta]t", "[", "1", "]"}], "'"}], "[", "s", 
              "]"}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalDelta]t", "[", "1", "]"}], "[", "s", "]"}],
                 "-", 
                RowBox[{
                 RowBox[{"F", "'"}], "[", "s", "]"}]}], ")"}], "2"]}], 
            ")"}]}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[CapitalDelta]t", "[", "1", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"2", 
              RowBox[{"B0", "[", "s", "]"}]}], ")"}], 
            RowBox[{"-", "1"}]], " ", 
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "s", "]"}]}]}], 
         "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funs1", "=", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"funs1", ",", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bexam1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Bexam", "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
             RowBox[{"\[Epsilon]", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], "/.", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Epsilon]", "k_"], "/;", 
            RowBox[{"k", ">", "1"}]}], "\[RuleDelayed]", "0"}]}], ",", 
         "\[Epsilon]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "k_"], "/;", 
         RowBox[{"k", ">", "1"}]}], "\[RuleDelayed]", "0"}]}], "//.", 
      "funs1"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.835924319904522*^9, 3.83592440665175*^9}, {
   3.835924442704462*^9, 3.835924595525572*^9}, {3.835924637345695*^9, 
   3.835924646459528*^9}, {3.835924686769541*^9, 3.8359247010183487`*^9}, {
   3.835924762994308*^9, 3.835924784122222*^9}, {3.836442623562769*^9, 
   3.8364426352258463`*^9}, 3.837131936245751*^9, {3.837132056958665*^9, 
   3.837132174352376*^9}, {3.837132230100749*^9, 3.837132236450862*^9}, {
   3.862251945380581*^9, 3.862251946319569*^9}, {3.8622521723505917`*^9, 
   3.862252295729027*^9}, {3.862252484415044*^9, 3.862252506032234*^9}, {
   3.862252542338648*^9, 3.862252543792204*^9}, {3.8622526393343563`*^9, 
   3.8622526415319967`*^9}, {3.862252840939704*^9, 3.86225286430723*^9}, {
   3.86225304689613*^9, 3.862253049994967*^9}, {3.862253554896172*^9, 
   3.862253601276833*^9}, {3.862254457196597*^9, 3.862254491378482*^9}, {
   3.862254560852014*^9, 3.862254563399714*^9}, {3.862254879167347*^9, 
   3.862254882530911*^9}, {3.862254959714233*^9, 3.862254971928405*^9}, {
   3.862256580713092*^9, 3.8622566199980173`*^9}, {3.873331288533491*^9, 
   3.873331307179323*^9}, {3.873331409022914*^9, 
   3.873331413586635*^9}},ExpressionUUID->"92f26c88-6c0c-4897-a13f-\
1bbfbc00f0e4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Double", " ", "checking", " ", "that", " ", "the", " ", "linear", " ", 
    "terms", " ", "produce", " ", "a", " ", "harmonic", " ", "oscillator", 
    " ", "in", " ", "x", " ", "with", " ", "rotation", " ", "\[Iota]0"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Out", " ", "should", " ", "be"}], " ", "-", 
    RowBox[{
     SuperscriptBox["\[Iota]0", "2"], " ", "x"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tt", "=", 
     RowBox[{
      RowBox[{"Taylor", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Bexam1", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "/", 
         RowBox[{
         "Bexam1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], ",", "1"}], "]"}], "/.", 
      RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tt", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{"tt", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", "FullSimplify"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ysol", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"x", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
         "tt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        "y"}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expr", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "tt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x", "[", "s", "]"}], ",", 
                 RowBox[{"y", "[", "s", "]"}]}], "}"}]}], "]"}]}], ",", "s"}],
            "]"}], "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "'"}], "[", "s", "]"}], "\[Rule]", 
           RowBox[{
           "tt", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", "s", "]"}], ",", 
             RowBox[{"y", "[", "s", "]"}]}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "/.", "ysol"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "s", "]"}], "\[Rule]", "xp"}]}], "/.", 
      "B0sub"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"expr", "=", 
    RowBox[{"Collect", "[", 
     RowBox[{"expr", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "xp"}], "}"}], ",", "FullSimplify"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.83592478667058*^9, 3.835924841376465*^9}, {
  3.835925069135509*^9, 3.8359251870100327`*^9}, {3.8371319566394157`*^9, 
  3.837131957532518*^9}, {3.86225233196006*^9, 3.862252339550137*^9}, {
  3.862252399670182*^9, 3.862252417248375*^9}, {3.862252567406185*^9, 
  3.862252600212133*^9}, {3.862252660305933*^9, 3.862252677439616*^9}, {
  3.862252876109898*^9, 3.862252919659527*^9}, {3.862253014946755*^9, 
  3.8622531788271503`*^9}, {3.862253621145494*^9, 3.862253631012192*^9}, {
  3.862254638201194*^9, 3.862254715870084*^9}, {3.8622549120340652`*^9, 
  3.8622549202139*^9}, {3.862254951571662*^9, 3.862254993009603*^9}, {
  3.8733313170513372`*^9, 3.873331381636127*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"46ae430d-1378-4e94-9e8e-20ae2706bb81"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "x"}], " ", 
  SuperscriptBox["\[Iota]0", "2"]}]], "Output",
 CellChangeTimes->{
  3.8622547160425653`*^9, {3.8622548914642763`*^9, 3.862254920388426*^9}, {
   3.8622549773580837`*^9, 3.862254993203783*^9}, {3.862255060640767*^9, 
   3.862255072330381*^9}, 3.862256622374096*^9, 3.8622567317055073`*^9, 
   3.862260346963616*^9, 3.863208124884207*^9, 3.864344923642188*^9, {
   3.873331351132938*^9, 3.873331382331375*^9}},
 CellLabel->"Out[48]=",ExpressionUUID->"39303b63-61eb-44e5-8e72-5b0c27aca064"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Order", " ", "2"}], ":", " ", 
    RowBox[{
    "set", " ", "all", " ", "free", " ", "terms", " ", "to", " ", "0"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Bexam2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Bexam", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
          RowBox[{"\[Epsilon]", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]", "^", "k_"}], "/;", 
         RowBox[{"k", "\[Equal]", "2"}]}], "\[RuleDelayed]", "1"}]}], "/.", 
      RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funs2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", 
         RowBox[{"2", ",", "__"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "2", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "2", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.835925211472891*^9, 3.835925379324065*^9}, {
  3.835925691051866*^9, 3.835925756970006*^9}, {3.862255005913232*^9, 
  3.862255031120185*^9}, {3.862255078264307*^9, 3.862255117039682*^9}, {
  3.862255211818761*^9, 3.862255355710713*^9}, {3.8733314178509197`*^9, 
  3.873331432457035*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"a703ba70-5956-42f7-9294-0c91c416ab7d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "8"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", 
       RowBox[{"B0", "[", "s", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["y", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], "2"], 
         "+", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], ")"}]}],
       "+", 
      RowBox[{"2", " ", "x", " ", "y", " ", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", " ", 
          SuperscriptBox["\[Kappa]0", "2"]}], "-", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], "2"], 
         "-", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], 
        ")"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", 
         RowBox[{"2", ",", "0"}], "]"}], "[", "s", "]"}]}], "+", 
      RowBox[{"6", " ", "x", " ", "y", " ", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "[", "s", "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["y", "2"], " ", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "2", "]"}], "[", "s", "]"}]}], "+", 
      RowBox[{"x", " ", 
       RowBox[{"\[Kappa]", "[", "s", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "x", " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "s", "]"}]}], "+", 
         RowBox[{"3", " ", "y", " ", 
          RowBox[{
           RowBox[{"\[Mu]", "[", "1", "]"}], "[", "s", "]"}]}], "-", 
         RowBox[{"x", " ", 
          RowBox[{
           SuperscriptBox["B0", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"B0", "[", "s", "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Kappa]", "\[Prime]",
         MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "6"}], " ", "x", " ", "y", " ", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", 
         RowBox[{"2", ",", "0"}], "]"}], "[", "s", "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["y", "2"], " ", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "[", "s", "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "2", "]"}], "[", "s", "]"}]}], "+", 
      RowBox[{"x", " ", 
       RowBox[{"\[Kappa]", "[", "s", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "y", " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "s", "]"}]}], "+", 
         RowBox[{"3", " ", "x", " ", 
          RowBox[{
           RowBox[{"\[Nu]", "[", "1", "]"}], "[", "s", "]"}]}], "-", 
         RowBox[{"y", " ", 
          RowBox[{
           SuperscriptBox["B0", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "x", " ", "y", " ", 
       RowBox[{"B0", "[", "s", "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Kappa]", "\[Prime]",
         MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.835925749597954*^9, 3.835925757272339*^9}, 
   3.8364426136397657`*^9, 3.836442647869615*^9, 3.836442733541973*^9, 
   3.837132256405658*^9, 3.840061136644106*^9, 3.8400628993768263`*^9, 
   3.8400629329954157`*^9, 3.8622550254649143`*^9, {3.862255081044703*^9, 
   3.862255118932131*^9}, {3.862255214418621*^9, 3.862255254546893*^9}, {
   3.862255342692487*^9, 3.8622553559668016`*^9}, 3.862256623991125*^9, 
   3.862256734303321*^9, 3.862260348838935*^9, 3.86320812755694*^9, 
   3.8643449257335033`*^9, {3.87333140216943*^9, 3.873331433273411*^9}},
 CellLabel->"Out[56]=",ExpressionUUID->"2b8a1890-2159-444a-b608-02c033ced162"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"order", " ", "3"}], ":", " ", 
    RowBox[{
    "set", " ", "all", " ", "free", " ", "terms", " ", "to", " ", "0"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Bexam3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Bexam", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
          RowBox[{"\[Epsilon]", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], "/.", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "k_"], "/;", 
         RowBox[{"k", "\[Equal]", "3"}]}], "\[RuleDelayed]", "1"}]}], "/.", 
      RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funs3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", 
         RowBox[{"3", ",", "__"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "3", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "3", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.835925392202024*^9, 3.83592544201475*^9}, {
  3.83592576700047*^9, 3.835925775336895*^9}, {3.862255364587078*^9, 
  3.8622554346311817`*^9}, {3.8622556011036253`*^9, 3.862255602375651*^9}, {
  3.8733314392819643`*^9, 3.873331439600569*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"cf27956c-a233-4dfc-ae41-cf7747b5f82f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"order", " ", "4"}], ":", " ", 
    RowBox[{
    "set", " ", "all", " ", "free", " ", "terms", " ", "to", " ", "0"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Bexam4", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Bexam", "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
           RowBox[{"\[Epsilon]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], "/.", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "k_"], "/;", 
          RowBox[{"k", "\[Equal]", "4"}]}], "\[RuleDelayed]", "1"}]}], "/.", 
       RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "/.", "B0sub"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funs4", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", 
         RowBox[{"4", ",", "__"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "4", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "4", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.835925448732333*^9, 3.835925470184781*^9}, {
  3.835925781025385*^9, 3.835925791307291*^9}, {3.8622554398046637`*^9, 
  3.862255447997109*^9}, {3.862255551767008*^9, 3.862255608563445*^9}, {
  3.873331450154408*^9, 3.8733314508326283`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"732a9dc8-e4f6-493e-b88c-7c9ca78643e6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Substituting", " ", "all", " ", "of", " ", "the", " ", "choices", " ", 
      "of", " ", "free", " ", "functions", " ", "at", " ", "each", " ", 
      "order", " ", "to", " ", "get", " ", "the", " ", "final", " ", 
      "example", " ", "B"}], "-", "field"}], ",", " ", "BexamFin"}], " ", 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"BexamFin", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Bexam", "//.", "funs1"}], "/.", "funs2"}], "/.", 
          "funs3"}], "/.", "funs4"}], "/.", "B0sub"}], "/.", "Fsub"}], "/.", 
      "curveVals"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"BexamFin", "=", 
    RowBox[{"Collect", "[", 
     RowBox[{"BexamFin", ",", "\[Epsilon]", ",", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", "Simplify"}], "]"}], "&"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8359255842523413`*^9, 3.835925628737797*^9}, {
   3.835925827257*^9, 3.8359258491752663`*^9}, {3.835925901767959*^9, 
   3.835925923983632*^9}, {3.835925955386828*^9, 3.835925956248537*^9}, {
   3.835926006479423*^9, 3.835926047468935*^9}, {3.83592627598883*^9, 
   3.835926280626257*^9}, 3.836442682312853*^9, {3.840062957019897*^9, 
   3.8400629579553137`*^9}, 3.862255630271298*^9, {3.862255689527377*^9, 
   3.8622556983978*^9}, {3.862255737044373*^9, 3.86225574078616*^9}, 
   3.86225677367636*^9, {3.873331673160359*^9, 3.873331725486032*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"480484d0-e173-4f7a-b751-ff96e2c3b4d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      FractionBox["1", "5"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}]], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["\[Kappa]0", "2"]}], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"10", " ", 
            SuperscriptBox["\[Iota]0", "2"]}]}], ")"}], "2"], 
        RowBox[{"100", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "/", "5"}]], " ", 
         SuperscriptBox[
          TemplateBox[{"1"},
           "C"], "2"]}]]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["x", "3"], " ", "\[Kappa]0", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        SuperscriptBox["\[Kappa]0", "2"]}], "+", 
       FractionBox[
        RowBox[{"3", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"10", " ", 
             SuperscriptBox["\[Iota]0", "2"]}]}], ")"}], "2"]}], 
        RowBox[{"100", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "/", "5"}]], " ", 
         SuperscriptBox[
          TemplateBox[{"1"},
           "C"], "2"]}]]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", "/", "5"}]], " ", 
     SuperscriptBox["y", "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"1"},
       "C"], "2"]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{"\[Kappa]0", "-", 
       RowBox[{
        FractionBox["3", "2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", "/", "5"}]], " ", 
        SuperscriptBox["y", "2"], " ", "\[Kappa]0", " ", 
        SuperscriptBox[
         TemplateBox[{"1"},
          "C"], "2"]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "5"]}], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", "s", "]"}]}], "5"]}]], " ", "y", " ", 
     TemplateBox[{"1"},
      "C"]}], "-", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", "5"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}]], " ", 
     SuperscriptBox["x", "4"], " ", 
     SuperscriptBox["\[Kappa]0", "3"], " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "5"]}], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", "s", "]"}]}], "5"]}]], " ", "y", " ", 
        "\[Kappa]0", " ", 
        TemplateBox[{"1"},
         "C"]}], "+", 
       RowBox[{
        FractionBox["1", "10"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          FractionBox["1", "5"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}]], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "5"]}], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", "s", "]"}]}], "5"]}]], " ", "y", " ", 
        SuperscriptBox["\[Kappa]0", "2"], " ", 
        TemplateBox[{"1"},
         "C"]}], "+", 
       RowBox[{
        FractionBox["1", "30"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          FractionBox["1", "5"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}]], " ", "\[Kappa]0", " ", 
        RowBox[{"Sin", "[", "s", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["x", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "5"]}], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", "s", "]"}]}], "5"]}]], " ", "y", " ", 
        SuperscriptBox["\[Kappa]0", "3"], " ", 
        TemplateBox[{"1"},
         "C"]}], "+", 
       RowBox[{
        FractionBox["1", "30"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          FractionBox["1", "5"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}]], " ", 
        SuperscriptBox["\[Kappa]0", "2"], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "10"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", "5"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}]], " ", "y", " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"200", " ", 
          SuperscriptBox["\[Iota]0", "2"]}], "-", 
         RowBox[{"20", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "s"}], "]"}]}], 
        RowBox[{"200", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"1", "/", "5"}]], " ", 
         TemplateBox[{"1"},
          "C"]}]], "+", 
       RowBox[{
        FractionBox["1", "30"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          FractionBox["1", "5"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}]], " ", "y", " ", 
        "\[Kappa]0", " ", 
        RowBox[{"Sin", "[", "s", "]"}]}]}], ")"}]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["x", "4"], " ", 
      SuperscriptBox["\[Kappa]0", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"100", " ", 
         SuperscriptBox["\[Iota]0", "2"]}], "+", 
        RowBox[{"10", " ", 
         RowBox[{"Cos", "[", "s", "]"}]}], "+", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "s", "]"}], "2"]}], ")"}]}], 
     RowBox[{"100", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"1", "/", "5"}]], " ", 
      TemplateBox[{"1"},
       "C"]}]], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "5"]}], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", "s", "]"}]}], "5"]}]], " ", 
        SuperscriptBox["y", "2"], " ", 
        SuperscriptBox["\[Kappa]0", "3"], " ", 
        TemplateBox[{"1"},
         "C"]}], "+", 
       RowBox[{
        FractionBox["1", "30"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          FractionBox["1", "5"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}]], " ", "y", " ", 
        SuperscriptBox["\[Kappa]0", "2"], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}], "-", 
       FractionBox[
        RowBox[{"\[Kappa]0", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"100", " ", 
            SuperscriptBox["\[Iota]0", "2"]}], "+", 
           RowBox[{"10", " ", 
            RowBox[{"Cos", "[", "s", "]"}]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "s", "]"}], "2"]}], ")"}]}], 
        RowBox[{"100", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"1", "/", "5"}]], " ", 
         TemplateBox[{"1"},
          "C"]}]]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["x", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["5", "6"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          FractionBox["1", "5"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}]], " ", "y", " ", 
        SuperscriptBox["\[Kappa]0", "3"], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[Kappa]0", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"100", " ", 
            SuperscriptBox["\[Iota]0", "2"]}], "+", 
           RowBox[{"10", " ", 
            RowBox[{"Cos", "[", "s", "]"}]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "s", "]"}], "2"]}], ")"}]}], 
        RowBox[{"100", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"1", "/", "5"}]], " ", 
         TemplateBox[{"1"},
          "C"]}]]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.835925624138949*^9, 3.835925629386753*^9}, {
   3.835925829045601*^9, 3.835925850864526*^9}, {3.835925889261979*^9, 
   3.8359259259669523`*^9}, 3.8359259578682947`*^9, {3.835926014905409*^9, 
   3.8359260288225403`*^9}, 3.835926084719173*^9, 3.8359263164970493`*^9, 
   3.836442690678171*^9, 3.836442763819162*^9, 3.837132273259778*^9, {
   3.84006294939853*^9, 3.840062968619112*^9}, {3.862255687807518*^9, 
   3.8622556902192717`*^9}, 3.8622557338726673`*^9, 3.8622565346570807`*^9, 
   3.862256630236348*^9, 3.8622567508309813`*^9, 3.8622567930188913`*^9, 
   3.862260360197233*^9, 3.8632081337837057`*^9, 3.8643449299821444`*^9, 
   3.873331725883647*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"6b033bf8-6caf-44fb-9496-51394d213b53"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing Poincare Section for choice of parameters", "Subsubsection",
 CellChangeTimes->{{3.836434305286606*^9, 3.836434306183784*^9}, {
  3.8733330041894407`*^9, 
  3.8733330427020082`*^9}},ExpressionUUID->"dd1c9b9b-b581-424f-b022-\
24c8704831cf"],

Cell["\<\
Currently C1, \[Iota]0 and \[Kappa]0 are parameters for our first family of \
example fields.
We now make a particular choice of parameters and view the magnetic field.\
\>", "Text",
 CellChangeTimes->{{3.873331749580533*^9, 3.8733317821410103`*^9}, {
  3.8733324354252367`*^9, 3.8733324668654213`*^9}, {3.873334534834248*^9, 
  3.873334535082402*^9}},ExpressionUUID->"e9fa7689-040f-4246-bd61-\
def03e782fab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"The", " ", "chosen", " ", "parameter", " ", "values"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"paramsub", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Rule]", "\[Iota]0"}], ",", 
      RowBox[{"\[Kappa]0", "\[Rule]", "1"}], ",", 
      RowBox[{"\[Iota]0", "\[Rule]", 
       RowBox[{"1", "/", "GoldenRatio"}]}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8364427839003468`*^9, 3.8364428361007767`*^9}, {
  3.8364428773131313`*^9, 3.836442893077382*^9}, {3.836443071896447*^9, 
  3.836443135452992*^9}, {3.837132304058194*^9, 3.8371323074673967`*^9}, {
  3.862257087000505*^9, 3.862257088940873*^9}, {3.8622572759783*^9, 
  3.8622572808151417`*^9}, {3.873332488043942*^9, 
  3.873332494377552*^9}},ExpressionUUID->"3db1f97e-de97-4c4a-a43c-\
19c2f1d562bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "example", " ", "vector", " ", "field", " ", "vf", " ", "with",
     " ", "params", " ", "substituted"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"vf", "=", 
    RowBox[{"BexamFin", "//.", "paramsub"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.835926498595772*^9, 3.835926509150484*^9}, 
   3.8359265637398453`*^9, {3.835926610037068*^9, 3.8359266274699917`*^9}, {
   3.835927159910331*^9, 3.835927182075758*^9}, {3.835927258521955*^9, 
   3.835927266867589*^9}, {3.835927628376504*^9, 3.835927628444742*^9}, {
   3.835927893101758*^9, 3.835927897208338*^9}, {3.835928370287133*^9, 
   3.83592838474489*^9}, {3.83643722505826*^9, 3.8364372258218527`*^9}, {
   3.836442840955517*^9, 3.8364428419013987`*^9}, 3.8364428957128363`*^9, {
   3.86225837387057*^9, 3.862258392958222*^9}, {3.862258454634918*^9, 
   3.8622584757183657`*^9}, 3.862258613551594*^9, {3.862260374485422*^9, 
   3.862260381897757*^9}, {3.863208153716155*^9, 3.863208156587347*^9}, {
   3.873332480540851*^9, 3.873332637827128*^9}, 
   3.873332901492886*^9},ExpressionUUID->"fd04b05c-ae2c-4643-bbd4-\
8813fbc1d8e2"],

Cell[TextData[{
 "We will now compute the ",
 StyleBox["Poincare section at s=0",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.873332913299281*^9, 3.873332935316616*^9}, {
  3.873333012629849*^9, 
  3.873333014102139*^9}},ExpressionUUID->"a92ae264-a6c4-42d5-a723-\
31cf960dda92"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "We", " ", "will", " ", "compute", " ", "a", " ", "Poincare", " ", 
      "section", " ", "at", " ", "s"}], "=", 
     RowBox[{
     "0.", "\[IndentingNewLine]", "This", " ", "is", " ", "most", " ", 
      "easily", " ", "done", " ", "by", " ", "taking", " ", "time", " ", "to",
       " ", "be", " ", "given", " ", "by", " ", "s"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "considering", " ", "B", " ", "as", " ", "a", " ", "non"}], 
     "-", 
     RowBox[{
     "autonomous", " ", "vector", " ", "field", " ", "with", " ", "only", " ",
       "x"}]}], ",", 
    RowBox[{"y", " ", 
     RowBox[{"components", ".", "\[IndentingNewLine]", "This"}], " ", "is", 
     " ", 
     RowBox[{"vf2", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"vf2", "=", 
    FractionBox[
     RowBox[{"vf", "\[LeftDoubleBracket]", 
      RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], 
     RowBox[{"vf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]]}], 
   ";"}], " "}]], "Input",
 CellChangeTimes->{{3.835926498595772*^9, 3.835926509150484*^9}, 
   3.8359265637398453`*^9, {3.835926610037068*^9, 3.8359266274699917`*^9}, {
   3.835927159910331*^9, 3.835927182075758*^9}, {3.835927258521955*^9, 
   3.835927266867589*^9}, {3.835927628376504*^9, 3.835927628444742*^9}, {
   3.835927893101758*^9, 3.835927897208338*^9}, {3.835928370287133*^9, 
   3.83592838474489*^9}, {3.83643722505826*^9, 3.8364372258218527`*^9}, {
   3.836442840955517*^9, 3.8364428419013987`*^9}, 3.8364428957128363`*^9, {
   3.86225837387057*^9, 3.862258392958222*^9}, {3.862258454634918*^9, 
   3.8622584757183657`*^9}, 3.862258613551594*^9, {3.862260374485422*^9, 
   3.862260381897757*^9}, {3.863208153716155*^9, 3.863208156587347*^9}, {
   3.873332480540851*^9, 3.873332637827128*^9}, 
   3.873332901492886*^9},ExpressionUUID->"06a5aebd-e08d-4dc1-b9f2-\
dcf7377bfa2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "nsolve", " ", "numerically", " ", "solves", " ", "the", " ", "non"}], 
    "-", 
    RowBox[{
    "autonomous", " ", "vector", " ", "field", " ", "vf2", " ", "with", " ", 
     "initial", " ", "condition", " ", "inits", " ", "for", " ", "s", " ", 
     "values", " ", "between", " ", "tmin", " ", "and", " ", "tmax"}]}], " ", 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"nsolve", "[", 
      RowBox[{"vf2_", ",", "inits_", ",", 
       RowBox[{"{", 
        RowBox[{"tmin_", ",", "tmax_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "'"}], "[", "s", "]"}], ",", 
              RowBox[{
               RowBox[{"y", "'"}], "[", "s", "]"}]}], "}"}], "\[Equal]", 
            RowBox[{"(", 
             RowBox[{"vf2", "/.", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "[", "s", "]"}], ",", 
                  RowBox[{"y", "[", "s", "]"}]}], "}"}]}], "]"}]}], ")"}]}], 
           "]"}], ",", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", "0", "]"}], ",", 
              RowBox[{"y", "[", "0", "]"}]}], "}"}], "\[Equal]", "inits"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "tmin", ",", "tmax"}], "}"}]}], "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"getpts", "[", "sol", "]"}], " ", "will", " ", "compute", " ", 
       "the", " ", "points", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", 
          RowBox[{"(", "s", ")"}]}], ",", 
         RowBox[{"y", 
          RowBox[{"(", "s", ")"}]}]}], ")"}], " ", "along", " ", "sols", " ", 
       "for", " ", "which", " ", "s"}], "=", 
      RowBox[{"0", " ", "mod", " ", "2", 
       RowBox[{"\[Pi]", ".", " ", "That"}], " ", "is"}]}], ",", " ", 
     RowBox[{
     "it", " ", "will", " ", "compute", " ", "the", " ", "orbit", " ", "on", 
      " ", "the", " ", "Poincare", " ", "section", " ", "of", " ", "the", " ",
       "numerical", " ", "solution", " ", "of", " ", "vf2", " ", "sols"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getpts", "[", "sol_", "]"}], ":=", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "[", "s", "]"}], ",", 
          RowBox[{"y", "[", "s", "]"}]}], "}"}], "/.", "sol"}], "/.", 
       RowBox[{"s", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]"}], " ", ")"}], 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Ceiling", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"x", "[", "\"\<Domain\>\"", "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
              RowBox[{"2", "\[Pi]"}]], "]"}], "/.", "sol"}], ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"x", "[", "\"\<Domain\>\"", "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
              RowBox[{"2", "\[Pi]"}]], "/.", "sol"}], "]"}]}], "]"}]}]}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.79514124109671*^9, 3.7951412554993877`*^9}, {
   3.79514132230504*^9, 3.795141473691152*^9}, {3.795301974901143*^9, 
   3.79530198984079*^9}, {3.795302079176005*^9, 3.7953020815648823`*^9}, {
   3.834890633302092*^9, 3.834890660486878*^9}, {3.834890810872081*^9, 
   3.834890823678051*^9}, {3.834890961456643*^9, 3.8348909629371634`*^9}, {
   3.83489171875994*^9, 3.834891721800827*^9}, 3.835927326687001*^9, {
   3.836443208454939*^9, 3.836443220089293*^9}, {3.86320823549958*^9, 
   3.863208238922534*^9}, {3.86320828010894*^9, 3.8632082803711147`*^9}, {
   3.8733326426318913`*^9, 3.8733327667943993`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"ce63e180-b265-45a7-9cde-6657524d3d0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Running", " ", "this", " ", "cell", " ", "will", " ", "produce", " ", "a",
     " ", "plot", " ", "of", " ", "Poincare", " ", 
    RowBox[{"section", ".", "\[IndentingNewLine]", "Clicking"}], " ", "in", 
    " ", "the", " ", "plot", " ", "will", " ", "compute", " ", "the", " ", 
    "orbit", " ", "on", " ", "the", " ", "Poincare", " ", "section", " ", 
    "of", " ", "the", " ", "initial", " ", "condition", " ", "from", " ", 
    "your", " ", "mouse", " ", "click"}], " ", "*)"}], " ", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"z", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"getpts", "[", 
         RowBox[{"Quiet", "[", 
          RowBox[{"nsolve", "[", 
           RowBox[{"vf2", ",", "#", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "300"}], " ", "2", "\[Pi]"}], ",", 
              RowBox[{"300", " ", "2", "\[Pi]"}]}], "}"}]}], "]"}], "]"}], 
         "]"}], "&"}], "/@", "u"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"plt", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"z", ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "1000"}], ",", 
        RowBox[{"Background", "\[Rule]", "White"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"PointSize", "[", "0.003", "]"}]}]}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", "Locator", ",", 
      RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
      RowBox[{"LocatorAutoCreate", "\[Rule]", "All"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"{", "}"}], ",", "None"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.792509674381559*^9, 3.7925098704124126`*^9}, {
   3.792509907865693*^9, 3.7925100547771473`*^9}, {3.792510509697153*^9, 
   3.792510518233576*^9}, {3.792511361604685*^9, 3.792511375384282*^9}, 
   3.792512733941688*^9, {3.792513226954212*^9, 3.792513260769885*^9}, {
   3.79251633462645*^9, 3.792516340620845*^9}, {3.792516423569372*^9, 
   3.792516434041267*^9}, {3.7951426678233767`*^9, 3.795142707187028*^9}, {
   3.7951431898854837`*^9, 3.79514320968561*^9}, 3.7952123775091753`*^9, 
   3.795214963874696*^9, {3.795301297612011*^9, 3.795301308010694*^9}, 
   3.795301708965281*^9, {3.795302205044664*^9, 3.7953022218777723`*^9}, {
   3.795306941539823*^9, 3.795306943490242*^9}, {3.795310493739643*^9, 
   3.795310520321406*^9}, 3.795314992572763*^9, {3.7954678203510036`*^9, 
   3.7954678280135202`*^9}, {3.795467908831739*^9, 3.795467909605208*^9}, {
   3.795467952564343*^9, 3.795467958970381*^9}, {3.795468259710527*^9, 
   3.795468271049223*^9}, 3.795474891551268*^9, {3.7954749599237213`*^9, 
   3.795474993780341*^9}, {3.795475046413424*^9, 3.7954750599554577`*^9}, {
   3.79547515662742*^9, 3.795475156728739*^9}, {3.795491945001478*^9, 
   3.7954920365884533`*^9}, {3.795492245771546*^9, 3.795492249201973*^9}, 
   3.7958150583072033`*^9, {3.8371343436916847`*^9, 3.837134428935747*^9}, {
   3.837134619382696*^9, 3.837134619991383*^9}, {3.837134679678409*^9, 
   3.8371347021712723`*^9}, 3.837134930902707*^9, {3.8371350609668818`*^9, 
   3.8371351390650797`*^9}, {3.837135191581629*^9, 3.8371352601798153`*^9}, {
   3.862337914383726*^9, 3.8623379225075407`*^9}, {3.873332793796812*^9, 
   3.8733328540095663`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"f9ba63ad-10eb-4dd8-83b6-ca0a8f91f543"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 2", "Subsection",
 CellChangeTimes->{{3.8371318187301693`*^9, 3.837131846018976*^9}, {
  3.862590656876403*^9, 3.8625906571084137`*^9}, {3.8626024123116693`*^9, 
  3.862602412384186*^9}},ExpressionUUID->"eaffa7ba-a1c9-479f-81b8-\
04b3cc935239"],

Cell["\<\
This is Example 2 of the paper. It is a degree 4 polynomial vector-field in \
x,y which satisfies isoprominence to order 3.\
\>", "Text",
 CellChangeTimes->{{3.8733330657303753`*^9, 
  3.8733330684149837`*^9}},ExpressionUUID->"cb8431ba-23fe-4fa7-b491-\
78301de5bcb3"],

Cell[CellGroupData[{

Cell["Equations defining the example", "Subsubsection",
 CellChangeTimes->{{3.835235642240221*^9, 3.835235644316049*^9}, {
  3.873329467768882*^9, 
  3.873329474664998*^9}},ExpressionUUID->"cefb2918-caf0-4368-8da5-\
844617a0e813"],

Cell[TextData[{
 "We choose ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["B", "0"], "(", "s", ")"}], " ", "=", " ", 
    RowBox[{
     SubscriptBox["C", "0"], 
     SuperscriptBox["e", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"F", "(", "s", ")"}], "-", 
         RowBox[{"F", "(", "0", ")"}]}], ")"}]}]]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1a3a49f2-bd0e-40f9-8526-703188a150c8"],
 " such that \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "(", "s", ")"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"a", " ", 
      RowBox[{"cos", "(", "s", ")"}]}], "+", 
     RowBox[{"b", " ", 
      RowBox[{"cos", "(", 
       RowBox[{"2", "s"}], ")"}]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "21297035-291e-4444-9e72-4da6cb83b8de"],
 ", \t ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"F", "'"}], 
     RowBox[{"(", "s", ")"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "a"}], " ", 
      RowBox[{"sin", "(", "s", ")"}]}], " ", "-", 
     RowBox[{"2", "b", " ", 
      RowBox[{"sin", "(", 
       RowBox[{"2", "s"}], ")"}]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "75f04649-8368-47c0-b510-4c1f0b0d4b76"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", " ", "<", " ", "a", " ", "<", " ", 
    RowBox[{"4", 
     RowBox[{"b", ".", " "}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "86d9fc7f-b972-4045-a295-2e06b3613c84"],
 "This guarantees that ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalSigma]", "-"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "790b94c8-7c3f-4f03-ae36-39dfc0774128"],
 " intersects the magnetic axis at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    RowBox[{"y", "=", "0"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2038158c-8ae7-4dad-9827-71ee1b772fd3"],
 " when ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["s", "*"], "=", "0"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1fe713c6-0101-4177-b755-c182befc8896"],
 " and \[Pi].\n\nWe choose the axis to be a simple circle so that \[Kappa](s) \
= ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Kappa]", "0"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b9e0c14b-3fc3-48b4-a1a9-40342de58b35"],
 " (const) and \[Tau](s) = 0"
}], "Text",
 CellChangeTimes->{{3.8352389746052027`*^9, 3.835239015307538*^9}, {
   3.835239080296011*^9, 3.835239101410684*^9}, {3.835923120408251*^9, 
   3.8359232539791193`*^9}, {3.835923296774247*^9, 3.835923301792025*^9}, {
   3.837131861036378*^9, 3.8371318941732817`*^9}, 3.860638261365808*^9, {
   3.8622506779759827`*^9, 3.862250696699889*^9}, 3.8622507385446587`*^9, {
   3.862590667157197*^9, 3.862590680982147*^9}, {3.862602421168415*^9, 
   3.8626024599430103`*^9}, 3.8626040653772173`*^9, {3.8626042283275433`*^9, 
   3.862604271071509*^9}, {3.8733330849681997`*^9, 3.873333086003907*^9}, {
   3.873333654348098*^9, 3.873333747966751*^9}, {3.873333780896193*^9, 
   3.873333781448614*^9}},ExpressionUUID->"f8e534f5-10b8-4717-90f8-\
1033765c9bb7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "s_", "]"}], ":=", 
   RowBox[{
    RowBox[{"a", " ", 
     RowBox[{"Cos", "[", "s", "]"}]}], "+", 
    RowBox[{"b", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", "s"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "F", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B0sub", "=", 
   RowBox[{"B0", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{"s", ",", 
      RowBox[{"Exp", "[", " ", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", "s", "]"}], "-", 
          RowBox[{"F", "[", "0", "]"}]}], ")"}]}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fsub", "=", 
   RowBox[{"F", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"Cos", "[", "s", "]"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "s"}], "]"}]}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", 
    RowBox[{"2", "\[Pi]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"The", " ", "period", " ", "of", " ", "s"}], "-", "coordinate"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", "=", "3"}], ";"}]}], "Input",
 CellChangeTimes->{{3.835923731532188*^9, 3.835923842277499*^9}, {
  3.835924650543433*^9, 3.835924655520781*^9}, {3.8371318995472507`*^9, 
  3.837131899843115*^9}, {3.840060870838526*^9, 3.840060872739153*^9}, {
  3.862251646373827*^9, 3.8622516477849483`*^9}, {3.86225172969318*^9, 
  3.86225174264642*^9}, {3.862604278073674*^9, 3.862604289287992*^9}, {
  3.862604536097789*^9, 3.862604537478224*^9}, {3.862604610369577*^9, 
  3.862604640741901*^9}, {3.862604671304967*^9, 3.8626046717171097`*^9}, {
  3.873333799501371*^9, 3.873333824551881*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"e926c928-0f77-446c-b055-554b7586bbb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Curve", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"curveVals", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Kappa]", "\[Rule]", 
       RowBox[{"Function", "[", 
        RowBox[{"s", ",", "\[Kappa]0"}], "]"}]}], ",", 
      RowBox[{"\[Tau]", "\[Rule]", 
       RowBox[{"Function", "[", 
        RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.835239106504346*^9, 3.8352391083697844`*^9}, {
   3.83523915513223*^9, 3.835239156328541*^9}, 3.8352394473784847`*^9, {
   3.862250735768674*^9, 3.862250736441684*^9}, {3.87333383119424*^9, 
   3.873333835055801*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"682b3873-b024-439b-a15e-63d5a66c80e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hsolfun", "=", 
   RowBox[{
    RowBox[{"SolveToFunction", "[", "hsols", "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", 
        RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}], "//.", 
        "hsolfun"}]}], "]"}], "]"}], "&"}], "/@", "hsols"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hrules", "=", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"B0", "'"}], "[", "st", "]"}], "\[Rule]", "0"}]}], "//", 
    "Flatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8622599086522093`*^9, 3.862260058566866*^9}, {
  3.86226010192946*^9, 3.86226010743011*^9}, {3.873333841787095*^9, 
  3.873333847664092*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"bcd9b3af-7cca-40db-b776-9fed59eb377a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"The", " ", "two", " ", "conditions", " ", "for", " ", 
     RowBox[{"isoprominence", ".", " ", "Each"}], " ", "stem", " ", "from", 
     " ", "the", " ", "stratum", " ", "at", " ", "st"}], "=", 
    RowBox[{"0", " ", "or", " ", "\[Pi]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"intconds1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"hrules", "/.", "B0sub"}], "/.", "curveVals"}], "/.", "Fsub"}],
      "/.", 
     RowBox[{"st", "\[Rule]", "0"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"intconds2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"hrules", "/.", "B0sub"}], "/.", "curveVals"}], "/.", "Fsub"}],
      "/.", 
     RowBox[{"st", "\[Rule]", "\[Pi]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.862260114032703*^9, 3.862260176257627*^9}, {
  3.8626047421952477`*^9, 3.8626047590114822`*^9}, {3.873333861946158*^9, 
  3.873333890432207*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"fcbfff29-dd5d-4c06-9bba-e223829c5f41"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "[", "0", "]"}], "\[Rule]", "0"}], ",", 
   
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    "\[Kappa]0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"0", ",", "2"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "8"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], "2"]}],
        "-", 
       SuperscriptBox[
        RowBox[{
         RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], ")"}]}]}],
    ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"1", ",", "1"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{
      RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["\[Kappa]0", "2"]}], "-", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], "2"]}],
        "-", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}]}], 
      ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"0", ",", "3"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "12"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], "[", "0", "]"}]}], "-", 
       RowBox[{"6", " ", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], " ", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "2", "]"}], "[", "0", "]"}]}]}], ")"}]}]}], 
   ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "24"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "9"}], " ", "\[Kappa]0", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], "2"],
           "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], 
         ")"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", 
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
           
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", 
               RowBox[{"2", ",", "0"}], "]"}], "[", "0", "]"}], "+", 
             RowBox[{
              RowBox[{"\[Mu]", "[", "2", "]"}], "[", "0", "]"}]}], ")"}]}], 
          "+", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", 
             RowBox[{"2", ",", "1"}], "]"}], "[", "0", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", " ", 
              RowBox[{
               RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}]}], "-", 
             RowBox[{"3", " ", 
              RowBox[{
               RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}]}], 
            ")"}]}]}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"2", ",", "1"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "12"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", 
          RowBox[{"2", ",", "0"}], "]"}], "[", "0", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{
            RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}]}], ")"}]}], 
       "-", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", 
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", 
             RowBox[{"2", ",", "1"}], "]"}], "[", "0", "]"}]}], "+", 
          RowBox[{"9", " ", "\[Kappa]0", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "-", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}], ")"}]}], 
          "-", 
          RowBox[{"6", " ", 
           RowBox[{
            RowBox[{"\[Nu]", "[", "2", "]"}], "[", "0", "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"3", ",", "0"}], "]"}], "[", "0", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"48", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "a"}], "-", 
          RowBox[{"4", " ", "b"}]}], ")"}], "3"], " ", 
       SuperscriptBox["\[Kappa]0", "3"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "a"}], "-", 
          RowBox[{"4", " ", "b"}]}], ")"}], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", 
            RowBox[{"2", ",", "0"}], "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{"9", " ", "\[Kappa]0", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], 
             "2"], "+", 
            SuperscriptBox[
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], 
           ")"}]}], "+", 
         RowBox[{"12", " ", 
          RowBox[{
           RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"\[Nu]", "[", "2", "]"}], "[", "0", "]"}]}]}], ")"}]}]}], 
     RowBox[{"48", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "-", 
         RowBox[{"4", " ", "b"}]}], ")"}], "3"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8622601149628277`*^9, 3.862260146223312*^9}, 
   3.86226017675712*^9, 3.862604759858789*^9, 3.8628598904199343`*^9, 
   3.862860063313747*^9, 3.8632152799208803`*^9, 3.863217189521422*^9, 
   3.864344216112852*^9, 3.87333389376703*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"59e39e6a-b9e3-49d3-851e-75fed3c151ad"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "[", "\[Pi]", "]"}], "\[Rule]", "0"}], 
   ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "[", "\[Pi]", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "4"}], " ", "a"}]], " ", "\[Kappa]0"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"0", ",", "2"}], "]"}], "[", "\[Pi]", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "8"]}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"4", " ", "a"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], 
        "2"], "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], "2"]}], 
      ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"1", ",", "1"}], "]"}], "[", "\[Pi]", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"4", " ", "a"}]], " ", 
     RowBox[{
      RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}], ")"}]}]}], 
   ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "[", "\[Pi]", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "4"}], " ", "a"}]], " ", 
        SuperscriptBox["\[Kappa]0", "2"]}], "-", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "a"}]], " ", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], 
         "2"]}], "-", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "a"}]], " ", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], "2"]}]}], 
      ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"0", ",", "3"}], "]"}], "[", "\[Pi]", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "12"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"4", " ", "a"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], " ", 
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], "[", "\[Pi]", "]"}]}], "-", 
       RowBox[{"6", " ", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], " ", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "2", "]"}], "[", "\[Pi]", "]"}]}]}], ")"}]}]}],
    ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "[", "\[Pi]", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "24"]}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"4", " ", "a"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"9", " ", "\[Kappa]0", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], 
           "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], "2"]}], 
         ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", 
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", 
               RowBox[{"2", ",", "0"}], "]"}], "[", "\[Pi]", "]"}], "+", 
             RowBox[{
              RowBox[{"\[Mu]", "[", "2", "]"}], "[", "\[Pi]", "]"}]}], 
            ")"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", 
             RowBox[{"2", ",", "1"}], "]"}], "[", "\[Pi]", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", " ", 
              RowBox[{
               RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}], "-", 
             RowBox[{"3", " ", 
              RowBox[{
               RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}]}], 
            ")"}]}]}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"2", ",", "1"}], "]"}], "[", "\[Pi]", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "12"]}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"4", " ", "a"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", 
          RowBox[{"2", ",", "0"}], "]"}], "[", "\[Pi]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{
            RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", 
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", 
             RowBox[{"2", ",", "1"}], "]"}], "[", "\[Pi]", "]"}]}], "+", 
          RowBox[{"9", " ", "\[Kappa]0", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], "-", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}], 
            ")"}]}], "-", 
          RowBox[{"6", " ", 
           RowBox[{
            RowBox[{"\[Nu]", "[", "2", "]"}], "[", "\[Pi]", "]"}]}]}], 
         ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Bs", "[", 
      RowBox[{"3", ",", "0"}], "]"}], "[", "\[Pi]", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"16", " ", "a"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"48", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "-", 
            RowBox[{"4", " ", "b"}]}], ")"}], "3"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "20"}], " ", "a"}]], " ", 
         SuperscriptBox["\[Kappa]0", "3"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "-", 
            RowBox[{"4", " ", "b"}]}], ")"}], "3"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "12"}], " ", "a"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", 
            RowBox[{
             RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], 
            " ", 
            RowBox[{
             RowBox[{"\[CapitalDelta]", "[", 
              RowBox[{"2", ",", "0"}], "]"}], "[", "\[Pi]", "]"}]}], "+", 
           RowBox[{"9", " ", "\[Kappa]0", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{
                RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", 
                "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], "2"]}],
              ")"}]}], "+", 
           RowBox[{"12", " ", 
            RowBox[{
             RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], " ", 
            RowBox[{
             RowBox[{"\[Nu]", "[", "2", "]"}], "[", "\[Pi]", "]"}]}]}], 
          ")"}]}]}], ")"}]}], 
     RowBox[{"48", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "-", 
         RowBox[{"4", " ", "b"}]}], ")"}], "3"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8622601149628277`*^9, 3.862260146223312*^9}, 
   3.86226017675712*^9, 3.862604759858789*^9, 3.8628598904199343`*^9, 
   3.862860063313747*^9, 3.8632152799208803`*^9, 3.863217189521422*^9, 
   3.864344216112852*^9, 3.873333893771006*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"e9c67895-cb52-4e5e-9867-2b2516b5431e"]
}, Open  ]],

Cell["\<\
The above is what needs to be true for isoprominence of order 3. 
This will define the coefficient values for the s-component of Bs at st1 = 0 \
and st2 = \[Pi].
We will choose an interpolation so that Bs =  1/2 \
Bs[0](1+Cos[s])+1/2Bs[\[Pi]](1-Cos[s])\
\>", "Text",
 CellChangeTimes->{{3.835239201556134*^9, 3.835239208711825*^9}, {
  3.835239280141889*^9, 3.8352392947546577`*^9}, {3.8622512856317167`*^9, 
  3.862251296700499*^9}, {3.8626059221385183`*^9, 3.862605969658991*^9}, {
  3.862606003091167*^9, 3.8626061071966963`*^9}, {3.862606172299893*^9, 
  3.862606173293127*^9}, {3.862606316046453*^9, 3.8626063297323103`*^9}, {
  3.862606364015068*^9, 3.862606383972616*^9}, {3.862860063874341*^9, 
  3.862860065313702*^9}, {3.873333899335968*^9, 
  3.873333947480649*^9}},ExpressionUUID->"2c38cd73-4d7a-4ef6-a7c6-\
7115be902864"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "generate", " ", "all", " ", "the", " ", "coefficients", " ", "in", " ", 
    "Bs"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BsCoeffs", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Bs", "@@", "#"}], ")"}], "[", "s", "]"}], "&"}], "/@", 
        RowBox[{"Compositions", "[", 
         RowBox[{"i", ",", "2"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "order"}], "}"}]}], "]"}], "//", 
     "Flatten"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.873333980946704*^9, 3.8733340104084167`*^9}, {
   3.873334157262927*^9, 3.8733341853141947`*^9}, 3.8733342593494797`*^9},
 CellLabel->
  "In[122]:=",ExpressionUUID->"c055bfdc-b8c2-4160-abb6-e67550262e9e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Bs0", "=", 
   RowBox[{
    RowBox[{"BsCoeffs", "/.", 
     RowBox[{"s", "\[Rule]", "0"}]}], "/.", "intconds1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bs1", "=", 
   RowBox[{
    RowBox[{"BsCoeffs", "/.", 
     RowBox[{"s", "\[Rule]", "\[Pi]"}]}], "/.", "intconds2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Bsinterp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Cos", "[", "s", "]"}]}], ")"}], "Bs0"}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Cos", "[", "s", "]"}]}], ")"}], "Bs1"}]}], "//", 
   "FullSimplify", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"takes", " ", "a", " ", "while", " ", "to", " ", "simplify"}], 
     "..."}], " ", "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.862606437410263*^9, 3.8626065739408503`*^9}, {
  3.87333418109308*^9, 3.873334202801709*^9}, {3.873334278060109*^9, 
  3.873334284586721*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"fc8a9b6e-27d0-48e4-9113-a3bbeb3a46a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[Kappa]0", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "4"}], " ", "a"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}], "+", 
      RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "16"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], "2"], 
         "+", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], ")"}]}],
       "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "a"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], 
          "2"], "+", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], "2"]}], 
        ")"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "8"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "a"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], " ", 
       
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], "-", 
         RowBox[{
          RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}], ")"}]}]}], 
     ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "16"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", " ", 
          SuperscriptBox["\[Kappa]0", "2"]}], "-", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], "2"], 
         "-", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], ")"}]}],
       "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "4"}], " ", "a"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], " ", 
          SuperscriptBox["\[Kappa]0", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"8", " ", "a"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}],
              "2"], "+", 
            SuperscriptBox[
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], "2"]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "8"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{
           RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"\[Mu]", "[", "2", "]"}], "[", "0", "]"}]}]}], ")"}]}], 
      "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "a"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], 
          " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "[", "\[Pi]", "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{
           RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], " ", 
          RowBox[{
           RowBox[{"\[Mu]", "[", "2", "]"}], "[", "\[Pi]", "]"}]}]}], 
        ")"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "48"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "9"}], " ", "\[Kappa]0", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], 
             "2"], "+", 
            SuperscriptBox[
             RowBox[{
              RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], 
           ")"}]}], "-", 
         RowBox[{"12", " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalDelta]", "[", 
              RowBox[{"2", ",", "0"}], "]"}], "[", "0", "]"}], "+", 
            RowBox[{
             RowBox[{"\[Mu]", "[", "2", "]"}], "[", "0", "]"}]}], ")"}]}], 
         "+", 
         RowBox[{"6", " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "[", "0", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             RowBox[{
              RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}]}], "+", 
            RowBox[{
             RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}], ")"}]}]}], 
        ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "a"}]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"9", " ", "\[Kappa]0", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}],
              "2"], "+", 
            SuperscriptBox[
             RowBox[{
              RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], "2"]}], 
           ")"}]}], "+", 
         RowBox[{"12", " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalDelta]", "[", 
              RowBox[{"2", ",", "0"}], "]"}], "[", "\[Pi]", "]"}], "+", 
            RowBox[{
             RowBox[{"\[Mu]", "[", "2", "]"}], "[", "\[Pi]", "]"}]}], ")"}]}],
          "+", 
         RowBox[{"6", " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "[", "\[Pi]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}], "-", 
            RowBox[{
             RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", 
            RowBox[{"2", ",", "0"}], "]"}], "[", "0", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}]}], ")"}]}], 
         "+", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "6"}], " ", 
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", 
               RowBox[{"2", ",", "1"}], "]"}], "[", "0", "]"}]}], "-", 
            RowBox[{"9", " ", "\[Kappa]0", " ", 
             RowBox[{
              RowBox[{"\[Mu]", "[", "1", "]"}], "[", "0", "]"}]}], "+", 
            RowBox[{"9", " ", "\[Kappa]0", " ", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}]}], "+", 
            RowBox[{"6", " ", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "2", "]"}], "[", "0", "]"}]}]}], 
           ")"}]}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "a"}]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", 
            RowBox[{"2", ",", "0"}], "]"}], "[", "\[Pi]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}]}], 
           ")"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"6", " ", 
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", 
               RowBox[{"2", ",", "1"}], "]"}], "[", "\[Pi]", "]"}]}], "+", 
            RowBox[{"9", " ", "\[Kappa]0", " ", 
             RowBox[{
              RowBox[{"\[Mu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}], "-", 
            RowBox[{"9", " ", "\[Kappa]0", " ", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}]}], "-", 
            RowBox[{"6", " ", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "2", "]"}], "[", "\[Pi]", "]"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "96"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", " ", 
          SuperscriptBox["\[Kappa]0", "3"]}], "-", 
         RowBox[{"3", " ", "\[Kappa]0", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], 
             "2"], "+", 
            SuperscriptBox[
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}], "2"]}], 
           ")"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "0", "]"}], 
             " ", 
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", 
               RowBox[{"2", ",", "0"}], "]"}], "[", "0", "]"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "0", "]"}], " ", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "2", "]"}], "[", "0", "]"}]}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "4"}], " ", "a"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Cos", "[", "s", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], " ", 
          SuperscriptBox["\[Kappa]0", "3"]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"8", " ", "a"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", "]"}],
              " ", 
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", 
               RowBox[{"2", ",", "0"}], "]"}], "[", "\[Pi]", "]"}]}], "+", 
            RowBox[{"3", " ", "\[Kappa]0", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{
                 RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "\[Pi]", 
                 "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{
                 RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], 
                "2"]}], ")"}]}], "+", 
            RowBox[{"4", " ", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "1", "]"}], "[", "\[Pi]", "]"}], " ", 
             RowBox[{
              RowBox[{"\[Nu]", "[", "2", "]"}], "[", "\[Pi]", "]"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.862606438662737*^9, 3.862606450503131*^9}, {
   3.862606480953957*^9, 3.8626065327709846`*^9}, {3.862606568800136*^9, 
   3.862606574196941*^9}, 3.8628600674746447`*^9, 3.863215282303809*^9, 
   3.8632171920060368`*^9, 3.864344218827854*^9, 3.873333960015469*^9, 
   3.873334172282902*^9, 3.873334207078231*^9, {3.8733342734397383`*^9, 
   3.873334288376562*^9}},
 CellLabel->
  "Out[128]=",ExpressionUUID->"47d9c7b1-5109-42dd-8335-9520fdcacf28"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Rules", " ", "for", " ", "Bs", " ", "so", " ", "that", " ", 
    "interpolation", " ", "holds", " ", "and", " ", "consequently", " ", 
    "isoprominence"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BsRules", "=", 
    RowBox[{
     RowBox[{"Thread", "[", 
      RowBox[{"BsCoeffs", "\[Rule]", "Bsinterp"}], "]"}], "//", 
     "SolveToFunction"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.86225923533762*^9, 3.862259298872529*^9}, {
  3.8622593520960817`*^9, 3.862259546147488*^9}, {3.862260181754199*^9, 
  3.862260240004695*^9}, {3.862260282168653*^9, 3.8622602942464237`*^9}, {
  3.8626047810784903`*^9, 3.862604804560412*^9}, {3.862606628374593*^9, 
  3.862606676708988*^9}, {3.8733342977011757`*^9, 3.8733343242820263`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"82f8523f-c25e-4ae1-bca6-5bbbdd8ab171"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Checking", " ", "that", " ", "both", " ", "the", " ", "isoprominence", 
    " ", "conditions", " ", "have", " ", "been", " ", "satisfied"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Output", " ", "should", " ", "be", " ", "two", " ", "vectors", " ", "of", 
    " ", "zeroes"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"intconds1", "/.", 
      RowBox[{"Rule", "\[Rule]", "Subtract"}]}], "/.", "BsRules"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"intconds2", "/.", 
      RowBox[{"Rule", "\[Rule]", "Subtract"}]}], "/.", "BsRules"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.8359240633577337`*^9, 3.835924159473929*^9}, {
   3.835924230994185*^9, 3.835924256256752*^9}, {3.862251442439541*^9, 
   3.862251464302438*^9}, 3.862251777228237*^9, {3.86225186093513*^9, 
   3.8622518918038597`*^9}, {3.862259652541972*^9, 3.862259688176694*^9}, {
   3.862260248176412*^9, 3.862260301641985*^9}, {3.86260668169864*^9, 
   3.862606698868144*^9}, {3.8733343282376738`*^9, 3.873334353586196*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"1e92169e-4c58-4e20-86f6-876eadef31fc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.835924070293025*^9, 3.8359241615754747`*^9}, {
   3.835924227999518*^9, 3.8359242574473963`*^9}, 3.8364425503887663`*^9, 
   3.8364427239126873`*^9, 3.837131916799596*^9, {3.840060925399135*^9, 
   3.840060935855042*^9}, 3.840061022375949*^9, 3.860099005392692*^9, {
   3.862251450019107*^9, 3.862251464788444*^9}, 3.862251777541975*^9, 
   3.862251828909487*^9, {3.862251862959042*^9, 3.862251892412747*^9}, 
   3.862259054423976*^9, 3.862259130984345*^9, {3.862259626397771*^9, 
   3.862259688516056*^9}, {3.862260243859006*^9, 3.86226030190038*^9}, {
   3.862606685132104*^9, 3.862606699180987*^9}, {3.862860100868288*^9, 
   3.862860117353002*^9}, 3.863215313564509*^9, 3.8632172222004347`*^9, 
   3.8643442501091557`*^9, 3.873334302593058*^9, 3.873334354106339*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"5eaaea74-0915-4407-bec6-06d940355356"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.835924070293025*^9, 3.8359241615754747`*^9}, {
   3.835924227999518*^9, 3.8359242574473963`*^9}, 3.8364425503887663`*^9, 
   3.8364427239126873`*^9, 3.837131916799596*^9, {3.840060925399135*^9, 
   3.840060935855042*^9}, 3.840061022375949*^9, 3.860099005392692*^9, {
   3.862251450019107*^9, 3.862251464788444*^9}, 3.862251777541975*^9, 
   3.862251828909487*^9, {3.862251862959042*^9, 3.862251892412747*^9}, 
   3.862259054423976*^9, 3.862259130984345*^9, {3.862259626397771*^9, 
   3.862259688516056*^9}, {3.862260243859006*^9, 3.86226030190038*^9}, {
   3.862606685132104*^9, 3.862606699180987*^9}, {3.862860100868288*^9, 
   3.862860117353002*^9}, 3.863215313564509*^9, 3.8632172222004347`*^9, 
   3.8643442501091557`*^9, 3.873334302593058*^9, 3.873334354109112*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"ec230d7c-7dda-4046-b649-d43baae176b1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"The", " ", "B"}], "-", 
    RowBox[{"field", " ", "for", " ", "example", " ", "2"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Bexam", "=", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Bdiv0", "[", "]"}], "//.", "BsRules"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
          RowBox[{"\[Epsilon]", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], ",", "\[Epsilon]"}], 
      "]"}], "/.", 
     RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.835235670401506*^9, 3.8352357855599327`*^9}, {
   3.835238530043662*^9, 3.835238535878191*^9}, {3.835239424229329*^9, 
   3.835239439600597*^9}, {3.835924310724128*^9, 3.8359243180867662`*^9}, {
   3.8622519011500072`*^9, 3.86225190685332*^9}, {3.862252059056177*^9, 
   3.862252066902657*^9}, {3.862255035698954*^9, 3.8622550694446287`*^9}, 
   3.862256709186388*^9, {3.873334359017291*^9, 3.873334361218664*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"8c7810e3-c3be-400e-b90c-6efc684e5cfa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Getting", " ", "linearisation", " ", "as", " ", "desired"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"funs1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Mu]", "[", "1", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", 
          RowBox[{"2", 
           RowBox[{"B0", "[", "s", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"C", "[", "1", "]"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"2", 
               RowBox[{"F", "[", "s", "]"}]}], "]"}]}], ")"}]}]}], "]"}]}], 
       ",", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "1", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", 
          RowBox[{"2", 
           SuperscriptBox[
            RowBox[{"C", "[", "1", "]"}], 
            RowBox[{"-", "1"}]], 
           RowBox[{"B0", "[", "s", "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "2"}], 
             RowBox[{"F", "[", "s", "]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "\[Iota]0"}], "T"], ")"}], "2"]}],
              "+", 
             RowBox[{
              RowBox[{"F", "''"}], "[", "s", "]"}], "-", 
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalDelta]t", "[", "1", "]"}], "'"}], "[", "s", 
              "]"}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalDelta]t", "[", "1", "]"}], "[", "s", "]"}],
                 "-", 
                RowBox[{
                 RowBox[{"F", "'"}], "[", "s", "]"}]}], ")"}], "2"]}], 
            ")"}]}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[CapitalDelta]t", "[", "1", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"2", 
              RowBox[{"B0", "[", "s", "]"}]}], ")"}], 
            RowBox[{"-", "1"}]], " ", 
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "[", "s", "]"}]}]}], 
         "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funs1", "=", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"funs1", ",", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", "1", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bexam1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Bexam", "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
             RowBox[{"\[Epsilon]", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], "/.", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Epsilon]", "k_"], "/;", 
            RowBox[{"k", ">", "1"}]}], "\[RuleDelayed]", "0"}]}], ",", 
         "\[Epsilon]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "k_"], "/;", 
         RowBox[{"k", ">", "1"}]}], "\[RuleDelayed]", "0"}]}], "//.", 
      "funs1"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.835924319904522*^9, 3.83592440665175*^9}, {
   3.835924442704462*^9, 3.835924595525572*^9}, {3.835924637345695*^9, 
   3.835924646459528*^9}, {3.835924686769541*^9, 3.8359247010183487`*^9}, {
   3.835924762994308*^9, 3.835924784122222*^9}, {3.836442623562769*^9, 
   3.8364426352258463`*^9}, 3.837131936245751*^9, {3.837132056958665*^9, 
   3.837132174352376*^9}, {3.837132230100749*^9, 3.837132236450862*^9}, {
   3.862251945380581*^9, 3.862251946319569*^9}, {3.8622521723505917`*^9, 
   3.862252295729027*^9}, {3.862252484415044*^9, 3.862252506032234*^9}, {
   3.862252542338648*^9, 3.862252543792204*^9}, {3.8622526393343563`*^9, 
   3.8622526415319967`*^9}, {3.862252840939704*^9, 3.86225286430723*^9}, {
   3.86225304689613*^9, 3.862253049994967*^9}, {3.862253554896172*^9, 
   3.862253601276833*^9}, {3.862254457196597*^9, 3.862254491378482*^9}, {
   3.862254560852014*^9, 3.862254563399714*^9}, {3.862254879167347*^9, 
   3.862254882530911*^9}, {3.862254959714233*^9, 3.862254971928405*^9}, {
   3.862256580713092*^9, 3.8622566199980173`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"0bd3bdb8-cae5-4c73-aec1-387748232988"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Checking", " ", "we", " ", "will", " ", "get", " ", "the", " ", 
    "harmonic", " ", "oscillator", " ", "for", " ", "x"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tt", "=", 
     RowBox[{
      RowBox[{"Taylor", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Bexam1", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "/", 
         RowBox[{
         "Bexam1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], ",", "1"}], "]"}], "/.", 
      RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tt", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{"%", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", "FullSimplify"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ysol", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"x", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{
         "tt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        "y"}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expr", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "tt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x", "[", "s", "]"}], ",", 
                 RowBox[{"y", "[", "s", "]"}]}], "}"}]}], "]"}]}], ",", "s"}],
            "]"}], "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "'"}], "[", "s", "]"}], "\[Rule]", 
           RowBox[{
           "tt", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", "s", "]"}], ",", 
             RowBox[{"y", "[", "s", "]"}]}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "/.", "ysol"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "s", "]"}], "\[Rule]", "xp"}]}], "/.", 
      "B0sub"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"expr", "=", 
    RowBox[{"Collect", "[", 
     RowBox[{"expr", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "xp"}], "}"}], ",", "FullSimplify"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.83592478667058*^9, 3.835924841376465*^9}, {
  3.835925069135509*^9, 3.8359251870100327`*^9}, {3.8371319566394157`*^9, 
  3.837131957532518*^9}, {3.86225233196006*^9, 3.862252339550137*^9}, {
  3.862252399670182*^9, 3.862252417248375*^9}, {3.862252567406185*^9, 
  3.862252600212133*^9}, {3.862252660305933*^9, 3.862252677439616*^9}, {
  3.862252876109898*^9, 3.862252919659527*^9}, {3.862253014946755*^9, 
  3.8622531788271503`*^9}, {3.862253621145494*^9, 3.862253631012192*^9}, {
  3.862254638201194*^9, 3.862254715870084*^9}, {3.8622549120340652`*^9, 
  3.8622549202139*^9}, {3.862254951571662*^9, 3.862254993009603*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"04252d1a-a7e3-4dd8-a64a-fbca7a0d4501"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "x"}], " ", 
  SuperscriptBox["\[Iota]0", "2"]}]], "Output",
 CellChangeTimes->{
  3.8622547160425653`*^9, {3.8622548914642763`*^9, 3.862254920388426*^9}, {
   3.8622549773580837`*^9, 3.862254993203783*^9}, {3.862255060640767*^9, 
   3.862255072330381*^9}, 3.862256622374096*^9, 3.8622567317055073`*^9, 
   3.862260346963616*^9, 3.862606706545685*^9, 3.8628601210229807`*^9, 
   3.863215313777216*^9, 3.8632172224389687`*^9, 3.864344250281262*^9, 
   3.873334373623866*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"9964ec6f-00bc-4fda-b7e5-9b9c67e16aaa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"order", " ", "2"}], ":", " ", 
    RowBox[{
    "set", " ", "all", " ", "free", " ", "terms", " ", "to", " ", "0"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Bexam2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Bexam", "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
           RowBox[{"\[Epsilon]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "^", "k_"}], "/;", 
          RowBox[{"k", "\[Equal]", "2"}]}], "\[RuleDelayed]", "1"}]}], "/.", 
       RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funs2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", 
         RowBox[{"2", ",", "__"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "2", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "2", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.835925211472891*^9, 3.835925379324065*^9}, {
  3.835925691051866*^9, 3.835925756970006*^9}, {3.862255005913232*^9, 
  3.862255031120185*^9}, {3.862255078264307*^9, 3.862255117039682*^9}, {
  3.862255211818761*^9, 3.862255355710713*^9}, {3.873334380996222*^9, 
  3.873334387565898*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"0560a314-1ecc-4541-b495-ff055585c3b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"order", " ", "3"}], ":", " ", 
    RowBox[{
    "set", " ", "all", " ", "free", " ", "terms", " ", "to", " ", "0"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Bexam3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Bexam", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
          RowBox[{"\[Epsilon]", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], "/.", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "k_"], "/;", 
         RowBox[{"k", "\[Equal]", "3"}]}], "\[RuleDelayed]", "1"}]}], "/.", 
      RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funs3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", 
         RowBox[{"3", ",", "__"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "3", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "3", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.835925392202024*^9, 3.83592544201475*^9}, {
  3.83592576700047*^9, 3.835925775336895*^9}, {3.862255364587078*^9, 
  3.8622554346311817`*^9}, {3.8622556011036253`*^9, 3.862255602375651*^9}, {
  3.873334389804409*^9, 3.873334392370528*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"f965690c-0483-419c-8b01-dad0c261c573"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"order", " ", "4"}], ":", " ", 
    RowBox[{
    "set", " ", "all", " ", "free", " ", "terms", " ", "to", " ", "0"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Bexam4", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Bexam", "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
           RowBox[{"\[Epsilon]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], "/.", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "k_"], "/;", 
          RowBox[{"k", "\[Equal]", "4"}]}], "\[RuleDelayed]", "1"}]}], "/.", 
       RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "/.", "B0sub"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funs4", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalDelta]", "[", 
         RowBox[{"4", ",", "__"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "4", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "4", "]"}], "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"s", ",", "0"}], "]"}]}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.835925448732333*^9, 3.835925470184781*^9}, {
  3.835925781025385*^9, 3.835925791307291*^9}, {3.8622554398046637`*^9, 
  3.862255447997109*^9}, {3.862255551767008*^9, 3.862255608563445*^9}, {
  3.8632153154171267`*^9, 3.863215316544018*^9}, {3.873334398124032*^9, 
  3.873334398402656*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"fee2576b-d6b1-4eb7-8703-c732e5c79aa6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Substituting", " ", "all", " ", "of", " ", "the", " ", "choices", " ", 
      "of", " ", "free", " ", "functions", " ", "at", " ", "each", " ", 
      "order", " ", "to", " ", "get", " ", "the", " ", "final", " ", 
      "example", " ", "B"}], "-", "field"}], ",", " ", "BexamFin"}], " ", 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"BexamFin", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Bexam", "//.", "funs1"}], "/.", "funs2"}], "/.", 
          "funs3"}], "/.", "funs4"}], "/.", "B0sub"}], "/.", "Fsub"}], "/.", 
      "curveVals"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"BexamFin", "=", 
    RowBox[{"Collect", "[", 
     RowBox[{"BexamFin", ",", "\[Epsilon]", ",", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", "Simplify"}], "]"}], "&"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8359255842523413`*^9, 3.835925628737797*^9}, {
   3.835925827257*^9, 3.8359258491752663`*^9}, {3.835925901767959*^9, 
   3.835925923983632*^9}, {3.835925955386828*^9, 3.835925956248537*^9}, {
   3.835926006479423*^9, 3.835926047468935*^9}, {3.83592627598883*^9, 
   3.835926280626257*^9}, 3.836442682312853*^9, {3.840062957019897*^9, 
   3.8400629579553137`*^9}, 3.862255630271298*^9, {3.862255689527377*^9, 
   3.8622556983978*^9}, {3.862255737044373*^9, 3.86225574078616*^9}, 
   3.86225677367636*^9, {3.873334446812915*^9, 3.873334468427034*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"90c3fd76-47db-4aeb-9516-1d41b4d359dd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      RowBox[{"(", 
       RowBox[{"a", "+", 
        RowBox[{"2", " ", "b"}], "+", 
        RowBox[{"2", " ", "b", " ", 
         RowBox[{"Cos", "[", "s", "]"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        FractionBox["s", "2"], "]"}], "2"]}]], "-", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], " ", "a"}], "+", 
       RowBox[{"4", " ", "b"}]}]], " ", 
     SuperscriptBox["y", "2"], " ", 
     SuperscriptBox[
      TemplateBox[{"1"},
       "C"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"12", " ", "a"}]], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"12", " ", "a"}]]}], ")"}], " ", 
        RowBox[{"Cos", "[", "s", "]"}]}]}], ")"}]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["x", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "4"}], " ", "a"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"4", " ", "a"}], "-", 
              RowBox[{"4", " ", "b"}]}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "a"}], "+", 
               RowBox[{"4", " ", "b"}], "+", 
               SuperscriptBox["\[Iota]0", "2"]}], ")"}], "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Kappa]0", "2"], " ", 
            SuperscriptBox[
             TemplateBox[{"1"},
              "C"], "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "4"}], " ", 
              RowBox[{"(", 
               RowBox[{"a", "+", "b"}], ")"}]}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"a", "+", 
               RowBox[{"4", " ", "b"}], "+", 
               SuperscriptBox["\[Iota]0", "2"]}], ")"}], "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Kappa]0", "2"], " ", 
            SuperscriptBox[
             TemplateBox[{"1"},
              "C"], "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}]}], ")"}]}], 
     RowBox[{"4", " ", 
      SuperscriptBox[
       TemplateBox[{"1"},
        "C"], "2"]}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["x", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "4"}], " ", "a"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"4", " ", "a"}], "-", 
              RowBox[{"4", " ", "b"}]}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "a"}], "+", 
               RowBox[{"4", " ", "b"}], "+", 
               SuperscriptBox["\[Iota]0", "2"]}], ")"}], "2"], " ", 
            "\[Kappa]0"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Kappa]0", "3"], " ", 
            SuperscriptBox[
             TemplateBox[{"1"},
              "C"], "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "4"}], " ", 
              RowBox[{"(", 
               RowBox[{"a", "+", "b"}], ")"}]}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"a", "+", 
               RowBox[{"4", " ", "b"}], "+", 
               SuperscriptBox["\[Iota]0", "2"]}], ")"}], "2"], " ", 
            "\[Kappa]0"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Kappa]0", "3"], " ", 
            SuperscriptBox[
             TemplateBox[{"1"},
              "C"], "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}]}], ")"}]}], 
     RowBox[{"4", " ", 
      SuperscriptBox[
       TemplateBox[{"1"},
        "C"], "2"]}]], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", "\[Kappa]0", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "4"}], " ", "a"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}], "+", 
          RowBox[{"Cos", "[", "s", "]"}]}], ")"}]}], "-", 
       RowBox[{
        FractionBox["3", "4"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "8"}], " ", "a"}], "+", 
          RowBox[{"4", " ", "b"}]}]], " ", 
        SuperscriptBox["y", "2"], " ", "\[Kappa]0", " ", 
        SuperscriptBox[
         TemplateBox[{"1"},
          "C"], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"12", " ", "a"}]], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"12", " ", "a"}]]}], ")"}], " ", 
           RowBox[{"Cos", "[", "s", "]"}]}]}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"4", " ", "a", " ", 
        RowBox[{"Cos", "[", "s", "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b", "-", 
          RowBox[{"2", " ", "b", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]}]], " ", "y", " ", 
     TemplateBox[{"1"},
      "C"]}], "-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"48", " ", 
       SuperscriptBox[
        TemplateBox[{"1"},
         "C"], "2"]}]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "4"}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}]}]], " ", 
     SuperscriptBox["x", "4"], " ", "\[Kappa]0", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"4", " ", "a"}]]}], ")"}]}], "-", 
       RowBox[{"24", " ", "a", " ", "b", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"4", " ", "a"}]]}], ")"}]}], "-", 
       RowBox[{"6", " ", "a", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"4", " ", "a"}]]}], ")"}], " ", 
        SuperscriptBox["\[Iota]0", "2"]}], "+", 
       RowBox[{"80", " ", "a", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b", "+", 
            RowBox[{"a", " ", 
             RowBox[{"Cos", "[", "s", "]"}]}], "+", 
            RowBox[{"b", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
        SuperscriptBox["\[Kappa]0", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"1"},
          "C"], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"4", " ", "a"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"48", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"24", " ", "b", " ", 
           SuperscriptBox["\[Iota]0", "2"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["\[Iota]0", "4"]}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"4", " ", "b"}]], " ", 
           SuperscriptBox["\[Kappa]0", "2"], " ", 
           SuperscriptBox[
            TemplateBox[{"1"},
             "C"], "2"]}]}], ")"}]}], "+", 
       RowBox[{"320", " ", "b", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b", "+", 
            RowBox[{"a", " ", 
             RowBox[{"Cos", "[", "s", "]"}]}], "+", 
            RowBox[{"b", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
        SuperscriptBox["\[Kappa]0", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"1"},
          "C"], "2"], " ", 
        RowBox[{"Cos", "[", "s", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b", "-", 
            RowBox[{"2", " ", "a", " ", 
             RowBox[{"Cos", "[", "s", "]"}]}], "-", 
            RowBox[{"2", " ", "b", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", "y", " ", 
        "\[Kappa]0", " ", 
        TemplateBox[{"1"},
         "C"]}], "-", 
       RowBox[{
        FractionBox["1", "16"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "8"}], " ", "a"}], "+", 
          RowBox[{"4", " ", "b"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"12", " ", "a"}]]}], ")"}], " ", 
        SuperscriptBox["y", "2"], " ", 
        SuperscriptBox[
         TemplateBox[{"1"},
          "C"], "2"], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b", "-", 
            RowBox[{"a", " ", 
             RowBox[{"Cos", "[", "s", "]"}]}], "-", 
            RowBox[{"b", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", 
          RowBox[{"4", " ", "b", " ", 
           RowBox[{"Cos", "[", "s", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["x", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b", "-", 
            RowBox[{"2", " ", "a", " ", 
             RowBox[{"Cos", "[", "s", "]"}]}], "-", 
            RowBox[{"2", " ", "b", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", "y", " ", 
        SuperscriptBox["\[Kappa]0", "3"], " ", 
        TemplateBox[{"1"},
         "C"]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"48", " ", 
          SuperscriptBox[
           TemplateBox[{"1"},
            "C"], "2"]}]], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "4"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "a"}]]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "a"}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"48", " ", 
              SuperscriptBox["b", "2"]}], "+", 
             RowBox[{"24", " ", "b", " ", 
              SuperscriptBox["\[Iota]0", "2"]}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["\[Iota]0", "4"]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"4", " ", "b"}]], " ", 
              SuperscriptBox["\[Kappa]0", "2"], " ", 
              SuperscriptBox[
               TemplateBox[{"1"},
                "C"], "2"]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "a", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"12", " ", "b", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", " ", "a"}]]}], ")"}]}], "+", 
             RowBox[{"3", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", " ", "a"}]]}], ")"}], " ", 
              SuperscriptBox["\[Iota]0", "2"]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"a", "+", "b", "+", 
                  RowBox[{"a", " ", 
                   RowBox[{"Cos", "[", "s", "]"}]}], "+", 
                  RowBox[{"b", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
              SuperscriptBox["\[Kappa]0", "2"], " ", 
              SuperscriptBox[
               TemplateBox[{"1"},
                "C"], "2"]}]}], ")"}]}], "+", 
          RowBox[{"64", " ", "b", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"a", "+", "b", "+", 
               RowBox[{"a", " ", 
                RowBox[{"Cos", "[", "s", "]"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
           SuperscriptBox["\[Kappa]0", "2"], " ", 
           SuperscriptBox[
            TemplateBox[{"1"},
             "C"], "2"], " ", 
           RowBox[{"Cos", "[", "s", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b", "-", 
            RowBox[{"2", " ", "a", " ", 
             RowBox[{"Cos", "[", "s", "]"}]}], "-", 
            RowBox[{"2", " ", "b", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", "y", " ", 
        SuperscriptBox["\[Kappa]0", "2"], " ", 
        TemplateBox[{"1"},
         "C"]}], "+", 
       RowBox[{
        FractionBox["1", "16"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "8"}], " ", "a"}], "+", 
          RowBox[{"4", " ", "b"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"12", " ", "a"}]]}], ")"}], " ", 
        SuperscriptBox["y", "2"], " ", "\[Kappa]0", " ", 
        SuperscriptBox[
         TemplateBox[{"1"},
          "C"], "2"], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "6"], " ", "\[Kappa]0", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "4"}], " ", "a"}]], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{"a", "+", "b", "-", 
               RowBox[{"a", " ", 
                RowBox[{"Cos", "[", "s", "]"}]}], "-", 
               RowBox[{"b", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", 
             RowBox[{"4", " ", "b", " ", 
              RowBox[{"Cos", "[", "s", "]"}]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "16"]}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], " ", "a"}], "+", 
       RowBox[{"4", " ", "b"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"12", " ", "a"}]]}], ")"}], " ", 
     SuperscriptBox["y", "3"], " ", 
     SuperscriptBox[
      TemplateBox[{"1"},
       "C"], "2"], " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "+", "b", "-", 
         RowBox[{"a", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "-", 
         RowBox[{"b", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", "y", " ", 
     RowBox[{"(", 
      RowBox[{"a", "+", 
       RowBox[{"4", " ", "b", " ", 
        RowBox[{"Cos", "[", "s", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}]}]], " ", 
      SuperscriptBox["x", "4"], " ", 
      SuperscriptBox["\[Kappa]0", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Iota]0", "2"], "+", 
        RowBox[{"4", " ", "b", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "s"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "s", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "s", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", 
           RowBox[{"8", " ", "a", " ", "b", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "s", "]"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["b", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "s"}], "]"}], "2"]}]}], ")"}]}], 
     TemplateBox[{"1"},
      "C"]], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["5", "16"]}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "8"}], " ", "a"}], "+", 
          RowBox[{"4", " ", "b"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"12", " ", "a"}]]}], ")"}], " ", 
        SuperscriptBox["y", "3"], " ", "\[Kappa]0", " ", 
        SuperscriptBox[
         TemplateBox[{"1"},
          "C"], "2"], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "6"], " ", "y", " ", "\[Kappa]0", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "4"}], " ", "a"}]], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{"a", "+", "b", "-", 
               RowBox[{"a", " ", 
                RowBox[{"Cos", "[", "s", "]"}]}], "-", 
               RowBox[{"b", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", 
             RowBox[{"4", " ", "b", " ", 
              RowBox[{"Cos", "[", "s", "]"}]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "b"}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Iota]0", "2"], "+", 
           RowBox[{"4", " ", "b", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "s"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "s", "]"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "s", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", 
              RowBox[{"8", " ", "a", " ", "b", " ", 
               SuperscriptBox[
                RowBox[{"Sin", "[", "s", "]"}], "2"]}]}], ")"}]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "s"}], "]"}], "2"]}]}], ")"}]}], 
        TemplateBox[{"1"},
         "C"]]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b", "-", 
            RowBox[{"2", " ", "a", " ", 
             RowBox[{"Cos", "[", "s", "]"}]}], "-", 
            RowBox[{"2", " ", "b", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
        SuperscriptBox["y", "2"], " ", 
        SuperscriptBox["\[Kappa]0", "3"], " ", 
        TemplateBox[{"1"},
         "C"]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"48", " ", 
          SuperscriptBox[
           TemplateBox[{"1"},
            "C"], "2"]}]], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "4"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}]}]], " ", "y", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "a"}]]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "a"}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"48", " ", 
              SuperscriptBox["b", "2"]}], "+", 
             RowBox[{"24", " ", "b", " ", 
              SuperscriptBox["\[Iota]0", "2"]}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["\[Iota]0", "4"]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"4", " ", "b"}]], " ", 
              SuperscriptBox["\[Kappa]0", "2"], " ", 
              SuperscriptBox[
               TemplateBox[{"1"},
                "C"], "2"]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "a", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"12", " ", "b", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", " ", "a"}]]}], ")"}]}], "+", 
             RowBox[{"3", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", " ", "a"}]]}], ")"}], " ", 
              SuperscriptBox["\[Iota]0", "2"]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"a", "+", "b", "+", 
                  RowBox[{"a", " ", 
                   RowBox[{"Cos", "[", "s", "]"}]}], "+", 
                  RowBox[{"b", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
              SuperscriptBox["\[Kappa]0", "2"], " ", 
              SuperscriptBox[
               TemplateBox[{"1"},
                "C"], "2"]}]}], ")"}]}], "+", 
          RowBox[{"64", " ", "b", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"a", "+", "b", "+", 
               RowBox[{"a", " ", 
                RowBox[{"Cos", "[", "s", "]"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
           SuperscriptBox["\[Kappa]0", "2"], " ", 
           SuperscriptBox[
            TemplateBox[{"1"},
             "C"], "2"], " ", 
           RowBox[{"Cos", "[", "s", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "b"}], ")"}]}]], " ", "\[Kappa]0", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Iota]0", "2"], "+", 
           RowBox[{"4", " ", "b", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "s"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "s", "]"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "s", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", 
              RowBox[{"8", " ", "a", " ", "b", " ", 
               SuperscriptBox[
                RowBox[{"Sin", "[", "s", "]"}], "2"]}]}], ")"}]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "s"}], "]"}], "2"]}]}], ")"}]}], 
        TemplateBox[{"1"},
         "C"]]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["x", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"48", " ", 
          SuperscriptBox[
           TemplateBox[{"1"},
            "C"], "2"]}]], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "4"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}]}]], " ", "y", " ", "\[Kappa]0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"51", " ", 
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "a"}]]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "a"}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"816", " ", 
              SuperscriptBox["b", "2"]}], "+", 
             RowBox[{"408", " ", "b", " ", 
              SuperscriptBox["\[Iota]0", "2"]}], "+", 
             RowBox[{"51", " ", 
              SuperscriptBox["\[Iota]0", "4"]}], "+", 
             RowBox[{"104", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"4", " ", "b"}]], " ", 
              SuperscriptBox["\[Kappa]0", "2"], " ", 
              SuperscriptBox[
               TemplateBox[{"1"},
                "C"], "2"]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "a", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"204", " ", "b", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", " ", "a"}]]}], ")"}]}], "+", 
             RowBox[{"51", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", " ", "a"}]]}], ")"}], " ", 
              SuperscriptBox["\[Iota]0", "2"]}], "-", 
             RowBox[{"200", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"a", "+", "b", "+", 
                  RowBox[{"a", " ", 
                   RowBox[{"Cos", "[", "s", "]"}]}], "+", 
                  RowBox[{"b", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
              SuperscriptBox["\[Kappa]0", "2"], " ", 
              SuperscriptBox[
               TemplateBox[{"1"},
                "C"], "2"]}]}], ")"}]}], "+", 
          RowBox[{"1600", " ", "b", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"a", "+", "b", "+", 
               RowBox[{"a", " ", 
                RowBox[{"Cos", "[", "s", "]"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]], " ", 
           SuperscriptBox["\[Kappa]0", "2"], " ", 
           SuperscriptBox[
            TemplateBox[{"1"},
             "C"], "2"], " ", 
           RowBox[{"Cos", "[", "s", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "s", "]"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "b"}], ")"}]}]], " ", 
         SuperscriptBox["\[Kappa]0", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Iota]0", "2"], "+", 
           RowBox[{"4", " ", "b", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "s"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "s", "]"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "s", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", 
              RowBox[{"8", " ", "a", " ", "b", " ", 
               SuperscriptBox[
                RowBox[{"Sin", "[", "s", "]"}], "2"]}]}], ")"}]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "s"}], "]"}], "2"]}]}], ")"}]}], 
        TemplateBox[{"1"},
         "C"]]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.835925624138949*^9, 3.835925629386753*^9}, {
   3.835925829045601*^9, 3.835925850864526*^9}, {3.835925889261979*^9, 
   3.8359259259669523`*^9}, 3.8359259578682947`*^9, {3.835926014905409*^9, 
   3.8359260288225403`*^9}, 3.835926084719173*^9, 3.8359263164970493`*^9, 
   3.836442690678171*^9, 3.836442763819162*^9, 3.837132273259778*^9, {
   3.84006294939853*^9, 3.840062968619112*^9}, {3.862255687807518*^9, 
   3.8622556902192717`*^9}, 3.8622557338726673`*^9, 3.8622565346570807`*^9, 
   3.862256630236348*^9, 3.8622567508309813`*^9, 3.8622567930188913`*^9, 
   3.862260360197233*^9, 3.8626067252052307`*^9, 3.862860136150268*^9, 
   3.863215324047964*^9, 3.863217271930828*^9, 3.864344274511055*^9, {
   3.873334460151651*^9, 3.8733344708548403`*^9}},
 CellLabel->
  "Out[156]=",ExpressionUUID->"2c159243-759f-4490-a474-7990054637bc"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing Poincare Section for choice of parameters", "Subsubsection",
 CellChangeTimes->{{3.836434305286606*^9, 3.836434306183784*^9}, {
   3.862860410399736*^9, 3.862860410544323*^9}, 
   3.8733344860119667`*^9},ExpressionUUID->"b62ff4f4-f6f4-424b-9bf0-\
39072008cdf4"],

Cell["\<\
Currently C1, \[Iota]0, \[Kappa]0, a and b are parameters for our second \
family of example fields.
  We now make a particular choice of parameters and view the magnetic field.\
\>", "Text",
 CellChangeTimes->{{3.8733344988393793`*^9, 
  3.873334524186269*^9}},ExpressionUUID->"ecb1982c-3a8f-4e62-a99a-\
b7bd2878b005"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Note", " ", "that", " ", "0"}], " ", "<", " ", "a", " ", "<", 
    " ", 
    RowBox[{"4", "b", " ", "for", " ", "two", " ", "maxima"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"paramsub", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"C", "[", "1", "]"}], "\[Rule]", "\[Iota]0"}], ",", 
       RowBox[{"\[Kappa]0", "\[Rule]", "1"}], ",", 
       RowBox[{"\[Iota]0", "\[Rule]", 
        RowBox[{"1", "/", "GoldenRatio"}]}], ",", 
       RowBox[{"a", "\[Rule]", 
        RowBox[{"1", "/", "10"}]}], ",", 
       RowBox[{"b", "\[Rule]", 
        RowBox[{"1", "/", "10"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"A", " ", "plot", " ", "of", " ", "the", " ", "on"}], "-", 
     RowBox[{"axis", " ", "magnetic", " ", "field", " ", "strength"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"B0", "[", "s", "]"}], "/.", "B0sub"}], "/.", "Fsub"}], "//.",
       "paramsub"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<s\>\"", ",", "\"\<|B|\>\""}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8364427839003468`*^9, 3.8364428361007767`*^9}, {
  3.8364428773131313`*^9, 3.836442893077382*^9}, {3.836443071896447*^9, 
  3.836443135452992*^9}, {3.837132304058194*^9, 3.8371323074673967`*^9}, {
  3.862257087000505*^9, 3.862257088940873*^9}, {3.8622572759783*^9, 
  3.8622572808151417`*^9}, {3.8626067567715807`*^9, 3.8626067614900293`*^9}, {
  3.8626068271030397`*^9, 3.8626068272028503`*^9}, {3.8626068838061857`*^9, 
  3.8626068838822308`*^9}, {3.862607051991703*^9, 3.8626070527549267`*^9}, {
  3.8626071104558773`*^9, 3.862607110547319*^9}, {3.8628601351824636`*^9, 
  3.862860176612575*^9}, {3.863215540178874*^9, 3.86321560137035*^9}, {
  3.863215640426581*^9, 3.863215659813917*^9}, {3.873334547245002*^9, 
  3.873334580019397*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"d984d29d-ae63-426e-9a01-1f3696443b1d"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1: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
//8/6/8A9b1tSA==
       "]]},
     Annotation[#, "Charting`Private`Tag$42018#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"s\"", TraditionalForm], 
    FormBox["\"|B|\"", TraditionalForm]},
  AxesOrigin->{0, 0.5352614293378499},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->
   NCache[{{0, 2 Pi}, {0.5352614293378499, 0.9999999999999918}}, {{
     0, 6.283185307179586}, {0.5352614293378499, 0.9999999999999918}}],
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.863215542262137*^9, 3.863215601850089*^9}, {
   3.8632156488423243`*^9, 3.8632156610138407`*^9}, 3.863217272065013*^9, 
   3.864344366867461*^9, {3.873334560845881*^9, 3.873334582160912*^9}},
 CellLabel->
  "Out[160]=",ExpressionUUID->"325ba6a0-86d8-46ba-a100-0c41ea63b5e9"]
}, Open  ]],

Cell[TextData[{
 "We will now compute the ",
 StyleBox["Poincare section at s=0",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.873332913299281*^9, 3.873332935316616*^9}, {
  3.873333012629849*^9, 
  3.873333014102139*^9}},ExpressionUUID->"44a3d2b1-25d2-4e3b-bc8a-\
0fd334a0b890"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vf", "=", 
    RowBox[{"BexamFin", "//.", "paramsub"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "We", " ", "will", " ", "compute", " ", "a", " ", "Poincare", " ", 
      "section", " ", "at", " ", "s"}], "=", 
     RowBox[{
     "0.", "\[IndentingNewLine]", "This", " ", "is", " ", "most", " ", 
      "easily", " ", "done", " ", "by", " ", "taking", " ", "time", " ", "to",
       " ", "be", " ", "given", " ", "by", " ", "s"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "considering", " ", "B", " ", "as", " ", "a", " ", "non"}], 
     "-", 
     RowBox[{
     "autonomous", " ", "vector", " ", "field", " ", "with", " ", "only", " ",
       "x"}]}], ",", 
    RowBox[{"y", " ", 
     RowBox[{"components", ".", "\[IndentingNewLine]", "This"}], " ", "is", 
     " ", 
     RowBox[{"vf2", "."}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vf2exam2", "=", 
   FractionBox[
    RowBox[{"vf", "\[LeftDoubleBracket]", 
     RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], 
    RowBox[{"vf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.835926498595772*^9, 3.835926509150484*^9}, 
   3.8359265637398453`*^9, {3.835926610037068*^9, 3.8359266274699917`*^9}, {
   3.835927159910331*^9, 3.835927182075758*^9}, {3.835927258521955*^9, 
   3.835927266867589*^9}, {3.835927628376504*^9, 3.835927628444742*^9}, {
   3.835927893101758*^9, 3.835927897208338*^9}, {3.835928370287133*^9, 
   3.83592838474489*^9}, {3.83643722505826*^9, 3.8364372258218527`*^9}, {
   3.836442840955517*^9, 3.8364428419013987`*^9}, 3.8364428957128363`*^9, {
   3.86225837387057*^9, 3.862258392958222*^9}, {3.862258454634918*^9, 
   3.8622584757183657`*^9}, 3.862258613551594*^9, {3.862260374485422*^9, 
   3.862260381897757*^9}, {3.862606771380967*^9, 3.862606775785348*^9}, {
   3.873334615237093*^9, 3.873334615696288*^9}, {3.873334758668034*^9, 
   3.873334760019525*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"69443bea-d18b-42f8-bc36-01c540f81dfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "nsolve", " ", "numerically", " ", "solves", " ", "the", " ", "non"}], 
    "-", 
    RowBox[{
    "autonomous", " ", "vector", " ", "field", " ", "vf2", " ", "with", " ", 
     "initial", " ", "condition", " ", "inits", " ", "for", " ", "s", " ", 
     "values", " ", "between", " ", "tmin", " ", "and", " ", "tmax"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nsolve", "[", 
     RowBox[{"vf2_", ",", "inits_", ",", 
      RowBox[{"{", 
       RowBox[{"tmin_", ",", "tmax_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "'"}], "[", "s", "]"}], ",", 
             RowBox[{
              RowBox[{"y", "'"}], "[", "s", "]"}]}], "}"}], "\[Equal]", 
           RowBox[{"(", 
            RowBox[{"vf2", "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x", "[", "s", "]"}], ",", 
                 RowBox[{"y", "[", "s", "]"}]}], "}"}]}], "]"}]}], ")"}]}], 
          "]"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", "0", "]"}], ",", 
             RowBox[{"y", "[", "0", "]"}]}], "}"}], "\[Equal]", "inits"}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "tmin", ",", "tmax"}], "}"}]}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.79514124109671*^9, 3.7951412554993877`*^9}, {
   3.79514132230504*^9, 3.795141473691152*^9}, {3.795301974901143*^9, 
   3.79530198984079*^9}, {3.795302079176005*^9, 3.7953020815648823`*^9}, {
   3.834890633302092*^9, 3.834890660486878*^9}, {3.834890810872081*^9, 
   3.834890823678051*^9}, {3.834890961456643*^9, 3.8348909629371634`*^9}, {
   3.83489171875994*^9, 3.834891721800827*^9}, 3.835927326687001*^9, {
   3.836443208454939*^9, 3.836443220089293*^9}, {3.8733346308170443`*^9, 
   3.873334651644431*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"43051f29-e29b-4b9b-b53f-8636ebe25fd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"getpts", "[", "sol", "]"}], " ", "will", " ", "compute", " ", 
      "the", " ", "points", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", 
         RowBox[{"(", "s", ")"}]}], ",", 
        RowBox[{"y", 
         RowBox[{"(", "s", ")"}]}]}], ")"}], " ", "along", " ", "sols", " ", 
      "for", " ", "which", " ", "s"}], "=", 
     RowBox[{"0", " ", "mod", " ", "2", 
      RowBox[{"\[Pi]", ".", " ", "That"}], " ", "is"}]}], ",", " ", 
    RowBox[{
    "it", " ", "will", " ", "compute", " ", "the", " ", "orbit", " ", "on", 
     " ", "the", " ", "Poincare", " ", "section", " ", "of", " ", "the", " ", 
     "numerical", " ", "solution", " ", "of", " ", "vf2", " ", "sols"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"getpts", "[", "sol_", "]"}], ":=", 
    RowBox[{"Transpose", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "[", "s", "]"}], ",", 
         RowBox[{"y", "[", "s", "]"}]}], "}"}], "/.", "sol"}], "/.", 
      RowBox[{"s", "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "\[Pi]"}], " ", ")"}], 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Ceiling", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"x", "[", "\"\<Domain\>\"", "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
             RowBox[{"2", "\[Pi]"}]], "]"}], "/.", "sol"}], ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"x", "[", "\"\<Domain\>\"", "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
             RowBox[{"2", "\[Pi]"}]], "/.", "sol"}], "]"}]}], "]"}]}]}]}], 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.834890825298338*^9, 3.834890839583804*^9}, {
   3.834890906000454*^9, 3.834891093374834*^9}, {3.834891544745376*^9, 
   3.834891547250285*^9}, {3.834891744712336*^9, 3.834892004297924*^9}, {
   3.834892884618926*^9, 3.834892950798531*^9}, {3.834893005662249*^9, 
   3.8348930417812757`*^9}, {3.834893094102474*^9, 3.834893156621558*^9}, {
   3.834893192700924*^9, 3.83489319282156*^9}, {3.8348932679314938`*^9, 
   3.8348932710086193`*^9}, {3.834893368914769*^9, 3.8348934064133463`*^9}, {
   3.834893445325671*^9, 3.834893567626175*^9}, {3.83489371257683*^9, 
   3.83489372976357*^9}, {3.834898090062664*^9, 3.834898090366858*^9}, {
   3.834898190491428*^9, 3.8348982493817368`*^9}, {3.834898609798665*^9, 
   3.8348986159547987`*^9}, 3.834898663814073*^9, {3.834898779115836*^9, 
   3.8348988551357822`*^9}, {3.834898905046513*^9, 3.834898908083301*^9}, {
   3.834961346107445*^9, 3.8349613732259693`*^9}, {3.834961422373711*^9, 
   3.834961426167614*^9}, {3.8349614598693132`*^9, 3.834961469615017*^9}, {
   3.834961533556821*^9, 3.8349616184370527`*^9}, {3.8349616587927732`*^9, 
   3.834961670572693*^9}, {3.8349617580237513`*^9, 3.834961783841323*^9}, {
   3.834961957222128*^9, 3.834961975488184*^9}, {3.8350343405459003`*^9, 
   3.8350343481634417`*^9}, {3.835034418475298*^9, 3.835034470426219*^9}, {
   3.835034817274109*^9, 3.835034817362308*^9}, {3.835036002268675*^9, 
   3.8350360548663054`*^9}, {3.835036135131876*^9, 3.835036161662088*^9}, {
   3.8350362323287373`*^9, 3.835036375785595*^9}, 3.8350520568044243`*^9, {
   3.835825056999339*^9, 3.835825060624155*^9}, {3.835825147357717*^9, 
   3.8358251505116663`*^9}, {3.835825264822589*^9, 3.835825289673028*^9}, {
   3.835825468981159*^9, 3.835825559431479*^9}, {3.8359273371304626`*^9, 
   3.8359273755129232`*^9}, {3.8359274964387817`*^9, 3.835927499993411*^9}, {
   3.835927536504509*^9, 3.835927540136348*^9}, {3.8359276838286324`*^9, 
   3.835927689252487*^9}, {3.835928320063135*^9, 3.835928330907462*^9}, {
   3.835928409264279*^9, 3.835928417671661*^9}, {3.836442921619117*^9, 
   3.8364429249963284`*^9}, {3.8364429750428057`*^9, 
   3.8364430052328053`*^9}, {3.83644322679993*^9, 3.836443229388788*^9}, {
   3.8364432747182093`*^9, 3.8364434122416153`*^9}, {3.837132360248188*^9, 
   3.837132360574835*^9}, {3.837132402449741*^9, 3.837132402740481*^9}, {
   3.8371326150664673`*^9, 3.8371326396627913`*^9}, {3.837133014570653*^9, 
   3.83713310837997*^9}, {3.837133154509821*^9, 3.83713315615135*^9}, {
   3.8371331962921953`*^9, 3.837133200039879*^9}, {3.837133320782874*^9, 
   3.8371333460749598`*^9}, {3.837133625767498*^9, 3.837133626691988*^9}, {
   3.837133685905908*^9, 3.83713377738019*^9}, {3.837133823812236*^9, 
   3.8371338574144163`*^9}, {3.837133888304345*^9, 3.837133888357552*^9}, {
   3.8622575916404753`*^9, 3.86225762565525*^9}, {3.862260536059846*^9, 
   3.8622605707953444`*^9}, {3.8623372632485943`*^9, 3.862337322918631*^9}, {
   3.8623373584423847`*^9, 3.862337359718947*^9}, {3.8623373937127333`*^9, 
   3.86233743982277*^9}, {3.862337835736803*^9, 3.8623378443089037`*^9}, {
   3.8632153434624357`*^9, 3.863215348666977*^9}, {3.873334668660728*^9, 
   3.873334669208201*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"5e24bea3-d722-486c-9029-df5e8c47deb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Running", " ", "this", " ", "cell", " ", "will", " ", "produce", " ", "a",
     " ", "plot", " ", "of", " ", "Poincare", " ", 
    RowBox[{"section", ".", "\[IndentingNewLine]", "Clicking"}], " ", "in", 
    " ", "the", " ", "plot", " ", "will", " ", "compute", " ", "the", " ", 
    "orbit", " ", "on", " ", "the", " ", "Poincare", " ", "section", " ", 
    "of", " ", "the", " ", "initial", " ", "condition", " ", "from", " ", 
    "your", " ", "mouse", " ", "click"}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"z", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"getpts", "[", 
         RowBox[{"Quiet", "[", 
          RowBox[{"nsolve", "[", 
           RowBox[{"vf2exam2", ",", "#", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "300"}], " ", "2", "\[Pi]"}], ",", 
              RowBox[{"300", " ", "2", "\[Pi]"}]}], "}"}]}], "]"}], "]"}], 
         "]"}], "&"}], "/@", "u"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"plt", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"z", ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "1000"}], ",", 
        RowBox[{"Background", "\[Rule]", "White"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"PointSize", "[", "0.003", "]"}]}]}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", "Locator", ",", 
      RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
      RowBox[{"LocatorAutoCreate", "\[Rule]", "All"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"{", "}"}], ",", "None"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.792509674381559*^9, 3.7925098704124126`*^9}, {
   3.792509907865693*^9, 3.7925100547771473`*^9}, {3.792510509697153*^9, 
   3.792510518233576*^9}, {3.792511361604685*^9, 3.792511375384282*^9}, 
   3.792512733941688*^9, {3.792513226954212*^9, 3.792513260769885*^9}, {
   3.79251633462645*^9, 3.792516340620845*^9}, {3.792516423569372*^9, 
   3.792516434041267*^9}, {3.7951426678233767`*^9, 3.795142707187028*^9}, {
   3.7951431898854837`*^9, 3.79514320968561*^9}, 3.7952123775091753`*^9, 
   3.795214963874696*^9, {3.795301297612011*^9, 3.795301308010694*^9}, 
   3.795301708965281*^9, {3.795302205044664*^9, 3.7953022218777723`*^9}, {
   3.795306941539823*^9, 3.795306943490242*^9}, {3.795310493739643*^9, 
   3.795310520321406*^9}, 3.795314992572763*^9, {3.7954678203510036`*^9, 
   3.7954678280135202`*^9}, {3.795467908831739*^9, 3.795467909605208*^9}, {
   3.795467952564343*^9, 3.795467958970381*^9}, {3.795468259710527*^9, 
   3.795468271049223*^9}, 3.795474891551268*^9, {3.7954749599237213`*^9, 
   3.795474993780341*^9}, {3.795475046413424*^9, 3.7954750599554577`*^9}, {
   3.79547515662742*^9, 3.795475156728739*^9}, {3.795491945001478*^9, 
   3.7954920365884533`*^9}, {3.795492245771546*^9, 3.795492249201973*^9}, 
   3.7958150583072033`*^9, {3.8371343436916847`*^9, 3.837134428935747*^9}, {
   3.837134619382696*^9, 3.837134619991383*^9}, {3.837134679678409*^9, 
   3.8371347021712723`*^9}, 3.837134930902707*^9, {3.8371350609668818`*^9, 
   3.8371351390650797`*^9}, {3.837135191581629*^9, 3.8371352601798153`*^9}, {
   3.862337914383726*^9, 3.8623379225075407`*^9}, {3.873334683235688*^9, 
   3.873334683846274*^9}, {3.873334793952252*^9, 3.873334794877616*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"01c631ab-2123-4a52-aa3a-9817339fc059"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1717, 932},
WindowMargins->{{-1855, Automatic}, {Automatic, 63}},
Magnification:>1.5 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 338, 5, 147, "Title",ExpressionUUID->"e86d89f5-bd28-4f5c-aaba-35d1096f7754"],
Cell[921, 29, 703, 15, 90, "Text",ExpressionUUID->"20dd0ee3-74ec-49a4-ac9a-d9caa9dbf955"],
Cell[CellGroupData[{
Cell[1649, 48, 214, 4, 105, "Chapter",ExpressionUUID->"dbb3074b-cbbd-427f-9927-1b44ccb0a50e"],
Cell[1866, 54, 650, 17, 125, "Text",ExpressionUUID->"94e1c713-3eef-4ac8-8f10-9a1207680f89"],
Cell[CellGroupData[{
Cell[2541, 75, 177, 3, 82, "Subsection",ExpressionUUID->"8af2adab-2348-489b-9326-5942de0b98f8"],
Cell[2721, 80, 474, 10, 86, "Input",ExpressionUUID->"1c445717-ef21-4bd2-8a69-68e4c7275dfc"],
Cell[3198, 92, 7183, 176, 1408, "Input",ExpressionUUID->"87d5cd1b-bfce-4377-b111-259d989131fa"],
Cell[10384, 270, 2552, 68, 354, "Input",ExpressionUUID->"152c4574-8d07-4439-b323-d4934afda311"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12973, 343, 163, 3, 82, "Subsection",ExpressionUUID->"9f04adcf-598a-4026-a55d-1bae40affe45"],
Cell[13139, 348, 650, 16, 116, "Input",ExpressionUUID->"41e17064-d2b7-4397-bddf-49925e6f379c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13838, 370, 153, 3, 105, "Chapter",ExpressionUUID->"98e1dbd4-7b0f-4985-9b62-d549777a510a"],
Cell[CellGroupData[{
Cell[14016, 377, 210, 4, 82, "Subsection",ExpressionUUID->"fa03a257-ed9d-4be8-9e1b-ed1b3369e3d9"],
Cell[14229, 383, 321, 7, 54, "Text",ExpressionUUID->"9fdf4663-0503-46e5-85f4-a98df6be4964"],
Cell[CellGroupData[{
Cell[14575, 394, 232, 4, 69, "Subsubsection",ExpressionUUID->"11e1f84b-7325-484b-be4b-f29b98e48940"],
Cell[14810, 400, 2733, 77, 276, "Text",ExpressionUUID->"d5ca1a3b-d7fd-4154-bf16-56ce1e1c14d5"],
Cell[17546, 479, 1602, 43, 218, "Input",ExpressionUUID->"d3a67aee-6952-4d25-84e2-d3e050c90db7"],
Cell[19151, 524, 782, 18, 82, "Input",ExpressionUUID->"f0f0a87f-4d64-4589-a128-855bec228a3b"],
Cell[19936, 544, 1383, 37, 150, "Input",ExpressionUUID->"fca5e18f-a3f1-473b-8fcc-1d5ecee2479a"],
Cell[CellGroupData[{
Cell[21344, 585, 677, 18, 82, "Input",ExpressionUUID->"76999f5b-688c-4a1e-a63e-58633a748fbd"],
Cell[22024, 605, 7287, 222, 322, "Output",ExpressionUUID->"41b1c874-2bf2-4191-a503-354a1b4beae1"]
}, Open  ]],
Cell[29326, 830, 647, 12, 125, "Text",ExpressionUUID->"199e1920-a6af-4c0c-9709-fbb07c118349"],
Cell[29976, 844, 749, 18, 82, "Input",ExpressionUUID->"6ad5577f-f637-4fd5-8fca-bc18eac09fef"],
Cell[CellGroupData[{
Cell[30750, 866, 1036, 22, 116, "Input",ExpressionUUID->"d8d7b524-2112-4a89-a98e-57be64331c4c"],
Cell[31789, 890, 950, 15, 53, "Output",ExpressionUUID->"f4265a60-82fe-4812-9f13-a0403adbf879"]
}, Open  ]],
Cell[32754, 908, 1252, 30, 82, "Input",ExpressionUUID->"c3dc9350-d76e-4747-a355-392e8229e50d"],
Cell[34009, 940, 5029, 127, 310, "Input",ExpressionUUID->"92f26c88-6c0c-4897-a13f-1bbfbc00f0e4"],
Cell[CellGroupData[{
Cell[39063, 1071, 3969, 103, 252, "Input",ExpressionUUID->"46ae430d-1378-4e94-9e8e-20ae2706bb81"],
Cell[43035, 1176, 541, 10, 53, "Output",ExpressionUUID->"39303b63-61eb-44e5-8e72-5b0c27aca064"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43613, 1191, 1846, 49, 116, "Input",ExpressionUUID->"a703ba70-5956-42f7-9294-0c91c416ab7d"],
Cell[45462, 1242, 4820, 129, 190, "Output",ExpressionUUID->"2b8a1890-2159-444a-b608-02c033ced162"]
}, Open  ]],
Cell[50297, 1374, 1787, 48, 116, "Input",ExpressionUUID->"cf27956c-a233-4dfc-ae41-cf7747b5f82f"],
Cell[52087, 1424, 1833, 49, 116, "Input",ExpressionUUID->"732a9dc8-e4f6-493e-b88c-7c9ca78643e6"],
Cell[CellGroupData[{
Cell[53945, 1477, 1708, 40, 116, "Input",ExpressionUUID->"480484d0-e173-4f7a-b751-ff96e2c3b4d0"],
Cell[55656, 1519, 10365, 308, 452, "Output",ExpressionUUID->"6b033bf8-6caf-44fb-9496-51394d213b53"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[66070, 1833, 255, 4, 55, "Subsubsection",ExpressionUUID->"dd1c9b9b-b581-424f-b022-24c8704831cf"],
Cell[66328, 1839, 419, 8, 90, "Text",ExpressionUUID->"e9fa7689-040f-4246-bd61-def03e782fab"],
Cell[66750, 1849, 894, 20, 82, "Input",ExpressionUUID->"3db1f97e-de97-4c4a-a43c-19c2f1d562bb"],
Cell[67647, 1871, 1180, 22, 82, "Input",ExpressionUUID->"fd04b05c-ae2c-4643-bbd4-8813fbc1d8e2"],
Cell[68830, 1895, 290, 8, 54, "Text",ExpressionUUID->"a92ae264-a6c4-42d5-a723-31cf960dda92"],
Cell[69123, 1905, 1986, 43, 216, "Input",ExpressionUUID->"06a5aebd-e08d-4dc1-b9f2-dcf7377bfa2b"],
Cell[71112, 1950, 4653, 117, 248, "Input",ExpressionUUID->"ce63e180-b265-45a7-9cde-6657524d3d0f"],
Cell[75768, 2069, 3798, 76, 184, "Input",ExpressionUUID->"f9ba63ad-10eb-4dd8-83b6-ca0a8f91f543"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79615, 2151, 258, 4, 82, "Subsection",ExpressionUUID->"eaffa7ba-a1c9-479f-81b8-04b3cc935239"],
Cell[79876, 2157, 277, 6, 54, "Text",ExpressionUUID->"cb8431ba-23fe-4fa7-b491-78301de5bcb3"],
Cell[CellGroupData[{
Cell[80178, 2167, 230, 4, 69, "Subsubsection",ExpressionUUID->"cefb2918-caf0-4368-8da5-844617a0e813"],
Cell[80411, 2173, 3262, 93, 196, "Text",ExpressionUUID->"f8e534f5-10b8-4717-90f8-1033765c9bb7"],
Cell[83676, 2268, 1991, 54, 218, "Input",ExpressionUUID->"e926c928-0f77-446c-b055-554b7586bbb2"],
Cell[85670, 2324, 779, 18, 82, "Input",ExpressionUUID->"682b3873-b024-439b-a15e-63d5a66c80e6"],
Cell[86452, 2344, 1066, 30, 116, "Input",ExpressionUUID->"bcd9b3af-7cca-40db-b776-9fed59eb377a"],
Cell[CellGroupData[{
Cell[87543, 2378, 1061, 27, 116, "Input",ExpressionUUID->"fcbfff29-dd5d-4c06-9bba-e223829c5f41"],
Cell[88607, 2407, 7606, 231, 324, "Output",ExpressionUUID->"59e39e6a-b9e3-49d3-851e-75fed3c151ad"],
Cell[96216, 2640, 8938, 261, 324, "Output",ExpressionUUID->"e9c67895-cb52-4e5e-9867-2b2516b5431e"]
}, Open  ]],
Cell[105169, 2904, 844, 15, 125, "Text",ExpressionUUID->"2c38cd73-4d7a-4ef6-a7c6-7115be902864"],
Cell[106016, 2921, 874, 24, 82, "Input",ExpressionUUID->"c055bfdc-b8c2-4160-abb6-e67550262e9e"],
Cell[CellGroupData[{
Cell[106915, 2949, 1143, 35, 116, "Input",ExpressionUUID->"fc8a9b6e-27d0-48e4-9113-a3bbeb3a46a2"],
Cell[108061, 2986, 15119, 437, 569, "Output",ExpressionUUID->"47d9c7b1-5109-42dd-8335-9520fdcacf28"]
}, Open  ]],
Cell[123195, 3426, 895, 19, 82, "Input",ExpressionUUID->"82f8523f-c25e-4ae1-bca6-5bbbdd8ab171"],
Cell[CellGroupData[{
Cell[124115, 3449, 1276, 29, 150, "Input",ExpressionUUID->"1e92169e-4c58-4e20-86f6-876eadef31fc"],
Cell[125394, 3480, 1026, 17, 76, "Output",ExpressionUUID->"5eaaea74-0915-4407-bec6-06d940355356"],
Cell[126423, 3499, 1026, 17, 76, "Output",ExpressionUUID->"ec230d7c-7dda-4046-b649-d43baae176b1"]
}, Open  ]],
Cell[127464, 3519, 1259, 31, 82, "Input",ExpressionUUID->"8c7810e3-c3be-400e-b90c-6efc684e5cfa"],
Cell[128726, 3552, 4760, 122, 276, "Input",ExpressionUUID->"0bd3bdb8-cae5-4c73-aec1-387748232988"],
Cell[CellGroupData[{
Cell[133511, 3678, 3625, 96, 218, "Input",ExpressionUUID->"04252d1a-a7e3-4dd8-a64a-fbca7a0d4501"],
Cell[137139, 3776, 595, 12, 76, "Output",ExpressionUUID->"9964ec6f-00bc-4fda-b7e5-9b9c67e16aaa"]
}, Open  ]],
Cell[137749, 3791, 1884, 51, 116, "Input",ExpressionUUID->"0560a314-1ecc-4541-b495-ff055585c3b4"],
Cell[139636, 3844, 1789, 49, 116, "Input",ExpressionUUID->"f965690c-0483-419c-8b01-dad0c261c573"],
Cell[141428, 3895, 1886, 51, 116, "Input",ExpressionUUID->"fee2576b-d6b1-4eb7-8703-c732e5c79aa6"],
Cell[CellGroupData[{
Cell[143339, 3950, 1712, 41, 116, "Input",ExpressionUUID->"90c3fd76-47db-4aeb-9516-1d41b4d359dd"],
Cell[145054, 3993, 32793, 909, 1322, "Output",ExpressionUUID->"2c159243-759f-4490-a474-7990054637bc"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[177896, 4908, 277, 4, 55, "Subsubsection",ExpressionUUID->"b62ff4f4-f6f4-424b-9bf0-39072008cdf4"],
Cell[178176, 4914, 329, 7, 90, "Text",ExpressionUUID->"ecb1982c-3a8f-4e62-a99a-b7bd2878b005"],
Cell[CellGroupData[{
Cell[178530, 4925, 2252, 53, 150, "Input",ExpressionUUID->"d984d29d-ae63-426e-9a01-1f3696443b1d"],
Cell[180785, 4980, 16121, 285, 401, "Output",ExpressionUUID->"325ba6a0-86d8-46ba-a100-0c41ea63b5e9"]
}, Open  ]],
Cell[196921, 5268, 290, 8, 54, "Text",ExpressionUUID->"44a3d2b1-25d2-4e3b-bc8a-0fd334a0b890"],
Cell[197214, 5278, 2144, 47, 284, "Input",ExpressionUUID->"69443bea-d18b-42f8-bc36-01c540f81dfc"],
Cell[199361, 5327, 2516, 64, 184, "Input",ExpressionUUID->"43051f29-e29b-4b9b-b53f-8636ebe25fd7"],
Cell[201880, 5393, 5276, 100, 180, "Input",ExpressionUUID->"5e24bea3-d722-486c-9029-df5e8c47deb0"],
Cell[207159, 5495, 3877, 78, 184, "Input",ExpressionUUID->"01c631ab-2123-4a52-aa3a-9817339fc059"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

